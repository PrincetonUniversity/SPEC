<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SPEC: src/xspech.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  },
  tex: {
    macros: {},
    packages: ['base','configmacros','amsmath','amssymb']
  }
};
window.MathJax = {
  loader: {
    load: ['[tex]/color', '[tex]/cancel']
  },
  tex: {
      tags: 'ams',
      packages: {'[+]': ['noerrors'],
                 '[+]': ['color'],
                 '[+]': ['verb'],
                 '[+]': ['cancel']
      },
      macros: { bm: ['{\\boldsymbol #1}',1]
      }
  }
};
// https://docs.mathjax.org/en/latest/web/configuration.html#configuring-and-loading-in-one-script
//(function () {
//  var script = document.createElement('script');
//  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js';
//  script.async = true;
//  document.head.appendChild(script);
//})();
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="SPEC_97x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SPEC<span id="projectnumber">&#160;3.20</span>
   </div>
   <div id="projectbrief">Stepped Pressure Equilibrium Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('xspech_8f90.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">xspech.f90 File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Main program.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a95271e8805067f801b5d4e524d6901d4"><td class="memItemLeft" align="right" valign="top">program&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xspech_8f90.html#a95271e8805067f801b5d4e524d6901d4">spec_main</a></td></tr>
<tr class="memdesc:a95271e8805067f801b5d4e524d6901d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main program of SPEC.  <a href="xspech_8f90.html#a95271e8805067f801b5d4e524d6901d4">More...</a><br /></td></tr>
<tr class="separator:a95271e8805067f801b5d4e524d6901d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fdc71dffd7c61ee4588a3f80d3ab9ce"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xspech_8f90.html#a9fdc71dffd7c61ee4588a3f80d3ab9ce">xspech</a></td></tr>
<tr class="memdesc:a9fdc71dffd7c61ee4588a3f80d3ab9ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main subroutine of SPEC.  <a href="xspech_8f90.html#a9fdc71dffd7c61ee4588a3f80d3ab9ce">More...</a><br /></td></tr>
<tr class="separator:a9fdc71dffd7c61ee4588a3f80d3ab9ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec8c366a4e6a6f1cc611939d5d6e5c2c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xspech_8f90.html#aec8c366a4e6a6f1cc611939d5d6e5c2c">read_command_args</a></td></tr>
<tr class="memdesc:aec8c366a4e6a6f1cc611939d5d6e5c2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read command-line arguments; in particular, determine input file (name or extension).  <a href="xspech_8f90.html#aec8c366a4e6a6f1cc611939d5d6e5c2c">More...</a><br /></td></tr>
<tr class="separator:aec8c366a4e6a6f1cc611939d5d6e5c2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48f45478dc2c9f70ea8aa1c60ad06503"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xspech_8f90.html#a48f45478dc2c9f70ea8aa1c60ad06503">spec</a></td></tr>
<tr class="memdesc:a48f45478dc2c9f70ea8aa1c60ad06503"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the main "driver" for the physics part of SPEC.  <a href="xspech_8f90.html#a48f45478dc2c9f70ea8aa1c60ad06503">More...</a><br /></td></tr>
<tr class="separator:a48f45478dc2c9f70ea8aa1c60ad06503"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1451823a7b97101a797de616250752c1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xspech_8f90.html#a1451823a7b97101a797de616250752c1">final_diagnostics</a></td></tr>
<tr class="memdesc:a1451823a7b97101a797de616250752c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Final diagnostics.  <a href="xspech_8f90.html#a1451823a7b97101a797de616250752c1">More...</a><br /></td></tr>
<tr class="separator:a1451823a7b97101a797de616250752c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a537af4990058c0b0f2cd8b3669af204f"><td class="memItemLeft" align="right" valign="top"><a id="a537af4990058c0b0f2cd8b3669af204f" name="a537af4990058c0b0f2cd8b3669af204f"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><b>ending</b></td></tr>
<tr class="memdesc:a537af4990058c0b0f2cd8b3669af204f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes output files, writes screen summary. <br /></td></tr>
<tr class="separator:a537af4990058c0b0f2cd8b3669af204f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Main program. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a95271e8805067f801b5d4e524d6901d4" name="a95271e8805067f801b5d4e524d6901d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95271e8805067f801b5d4e524d6901d4">&#9670;&nbsp;</a></span>spec_main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">program spec_main</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main program of SPEC. </p>
<p >This only calls the xpech() subroutine to do a stand-alone SPEC run. </p><dl class="section return"><dt>Returns</dt><dd>none </dd></dl>

<p class="reference">References <a class="el" href="xspech_8f90.html#a9fdc71dffd7c61ee4588a3f80d3ab9ce">xspech()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="xspech_8f90_a95271e8805067f801b5d4e524d6901d4_cgraph.svg" width="2444" height="2823"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a9fdc71dffd7c61ee4588a3f80d3ab9ce" name="a9fdc71dffd7c61ee4588a3f80d3ab9ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fdc71dffd7c61ee4588a3f80d3ab9ce">&#9670;&nbsp;</a></span>xspech()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine xspech</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main subroutine of SPEC. </p>
<p >This orchestrates a stand-alone SPEC run: </p><ul>
<li>
read the input file  </li>
<li>
solve the MRxMHD equilibrium (see <a class="el" href="xspech_8f90.html#a48f45478dc2c9f70ea8aa1c60ad06503" title="This is the main &quot;driver&quot; for the physics part of SPEC.">spec()</a> ) </li>
<li>
run some diagnostics on the results  </li>
<li>
write the output file(s)  </li>
</ul>
<p ><b>reading input, allocating global variables</b></p>
<ul>
<li>
The input namelists and geometry are read in via a call to readin() . A full description of the required input is given in <a class="el" href="global_8f90.html" title="Defines input namelists and global variables, and opens some output files.">global.f90</a> .  </li>
<li>
Most internal variables, global memory etc., are allocated in <a class="el" href="group__grp__initialization.html#ga28628de0fdb3b3497668007d8d0643bd" title="Allocates and initializes internal arrays.">preset()</a> .  </li>
<li>
All quantities in the input file are mirrored into the output file's group <code>/input</code> .  </li>
</ul>
<p ><b>preparing output file group iterations</b></p>
<ul>
<li>
The group <code>/iterations</code> is created in the output file. This group contains the interface geometry at each iteration, which is useful for constructing movies illustrating the convergence. The data structure in use is an unlimited array of the following compound datatype: <div class="fragment"><div class="line">DATATYPE  H5T_COMPOUND {</div>
<div class="line">      H5T_NATIVE_INTEGER <span class="stringliteral">&quot;nDcalls&quot;</span>;</div>
<div class="line">      H5T_NATIVE_DOUBLE <span class="stringliteral">&quot;Energy&quot;</span>;</div>
<div class="line">      H5T_NATIVE_DOUBLE <span class="stringliteral">&quot;ForceErr&quot;</span>;</div>
<div class="line">      H5T_ARRAY { [Mvol+1][<a class="code hl_variable" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400" title="total number of Fourier harmonics for coordinates/fields; calculated from Mpol, Ntor in readin()">mn</a>] H5T_NATIVE_DOUBLE } <span class="stringliteral">&quot;iRbc&quot;</span>;</div>
<div class="line">      H5T_ARRAY { [Mvol+1][<a class="code hl_variable" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400" title="total number of Fourier harmonics for coordinates/fields; calculated from Mpol, Ntor in readin()">mn</a>] H5T_NATIVE_DOUBLE } <span class="stringliteral">&quot;iZbs&quot;</span>;</div>
<div class="line">      H5T_ARRAY { [Mvol+1][<a class="code hl_variable" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400" title="total number of Fourier harmonics for coordinates/fields; calculated from Mpol, Ntor in readin()">mn</a>] H5T_NATIVE_DOUBLE } <span class="stringliteral">&quot;iRbs&quot;</span>;</div>
<div class="line">      H5T_ARRAY { [Mvol+1][<a class="code hl_variable" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400" title="total number of Fourier harmonics for coordinates/fields; calculated from Mpol, Ntor in readin()">mn</a>] H5T_NATIVE_DOUBLE } <span class="stringliteral">&quot;iZbc&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->  </li>
</ul>
<p ><b>restart files</b></p>
<ul>
<li>
<a class="el" href="group__grp__output.html#ga282c297c96abdab5e76b5ace440b09a8" title="Write the restart file ext.sp.end.">wrtend()</a> is called to write the restart files.  </li>
</ul>

<p class="reference">References <a class="el" href="namespaceallglobal.html#a50e99bda692e1d2e3fa68857b67db880">allglobal::broadcast_inputs()</a>, <a class="el" href="namespaceallglobal.html#a7824bc37519fe88336534ce90ab2af16">allglobal::check_inputs()</a>, <a class="el" href="namespaceallglobal.html#afae71b580d9f9c71a6796207a5411959">allglobal::cpus</a>, <a class="el" href="xspech_8f90.html#a537af4990058c0b0f2cd8b3669af204f">ending()</a>, <a class="el" href="xspech_8f90.html#a1451823a7b97101a797de616250752c1">final_diagnostics()</a>, <a class="el" href="group__grp__output.html#gadb720ea6408b8f7681bfb7f86a4b86f2">sphdf5::finish_outfile()</a>, <a class="el" href="group__grp__output.html#ga593e99355c8ceabe56a566e9d468dbd9">sphdf5::hdfint()</a>, <a class="el" href="group__grp__output.html#gab348ec00943ff875a1ebb965fb98841e">sphdf5::init_convergence_output()</a>, <a class="el" href="group__grp__output.html#ga0f962c09cd5d5eba99f1cba043cb3898">sphdf5::init_outfile()</a>, <a class="el" href="namespacenumerical.html#aea05f4db240ea6b0e2686b16ec525a12">numerical::machprec</a>, <a class="el" href="group__grp__output.html#gafed4d951aec99f2ebeba68c465eb9861">sphdf5::mirror_input_to_outfile()</a>, <a class="el" href="namespaceallglobal.html#a2382df770fc57cc53ed68c6e1ac23819">allglobal::mpi_comm_spec</a>, <a class="el" href="namespaceallglobal.html#aca1163f9aab48251a99d00e63618cc39">allglobal::myid</a>, <a class="el" href="namespaceallglobal.html#aa45097c36006ab1ffc0cb06a927ed02a">allglobal::ncpu</a>, <a class="el" href="namespacefileunits.html#a7463305b9ff5b4b659d87f6fa59f74a7">fileunits::ounit</a>, <a class="el" href="group__grp__initialization.html#ga28628de0fdb3b3497668007d8d0643bd">preset()</a>, <a class="el" href="xspech_8f90.html#aec8c366a4e6a6f1cc611939d5d6e5c2c">read_command_args()</a>, <a class="el" href="namespacenumerical.html#aba4e665eb2dabaf1e12c82a7270ac0c0">numerical::small</a>, <a class="el" href="xspech_8f90.html#a48f45478dc2c9f70ea8aa1c60ad06503">spec()</a>, <a class="el" href="namespacenumerical.html#a37691ec078f21840c475c4c7b83d7d31">numerical::vsmall</a>, <a class="el" href="group__grp__output.html#ga17e65b951634f7098213fd071d905482">sphdf5::write_grid()</a>, <a class="el" href="group__grp__output.html#ga282c297c96abdab5e76b5ace440b09a8">allglobal::wrtend()</a>, and <a class="el" href="xspech_8f90.html#a9fdc71dffd7c61ee4588a3f80d3ab9ce">xspech()</a>.</p>

<p class="reference">Referenced by <a class="el" href="xspech_8f90.html#a1451823a7b97101a797de616250752c1">final_diagnostics()</a>, <a class="el" href="xspech_8f90.html#a48f45478dc2c9f70ea8aa1c60ad06503">spec()</a>, <a class="el" href="xspech_8f90.html#a95271e8805067f801b5d4e524d6901d4">spec_main()</a>, and <a class="el" href="xspech_8f90.html#a9fdc71dffd7c61ee4588a3f80d3ab9ce">xspech()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="xspech_8f90_a9fdc71dffd7c61ee4588a3f80d3ab9ce_cgraph.svg" width="2284" height="2820"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="xspech_8f90_a9fdc71dffd7c61ee4588a3f80d3ab9ce_icgraph.svg" width="1040" height="510"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aec8c366a4e6a6f1cc611939d5d6e5c2c" name="aec8c366a4e6a6f1cc611939d5d6e5c2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec8c366a4e6a6f1cc611939d5d6e5c2c">&#9670;&nbsp;</a></span>read_command_args()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine read_command_args</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read command-line arguments; in particular, determine input file (name or extension). </p>
<ul>
<li>
The input file name, <code>ext</code> , is given as the first command line input, and the input file itself is then <code>ext.sp</code> . </li>
<li>
Alternatively, you can directly specify the input file itself as <code>ext.sp</code> . </li>
<li>
You can also generate a template input file using <code>xspec</code> -i . </li>
<li>
Or print help information using <code>xspec</code> -h . </li>
<li>
Additional command line inputs recognized are: <ul>
<li>
<code>-readin</code> will immediately set <code>Wreadin=T</code> ; this may be over-ruled when the namelist <code>screenlist</code> is read </li>
</ul>
</li>
</ul>

<p class="reference">References <a class="el" href="namespaceallglobal.html#afae71b580d9f9c71a6796207a5411959">allglobal::cpus</a>, <a class="el" href="namespaceallglobal.html#a2382df770fc57cc53ed68c6e1ac23819">allglobal::mpi_comm_spec</a>, <a class="el" href="namespaceallglobal.html#aca1163f9aab48251a99d00e63618cc39">allglobal::myid</a>, <a class="el" href="namespacefileunits.html#a7463305b9ff5b4b659d87f6fa59f74a7">fileunits::ounit</a>, and <a class="el" href="group__grp__global__screenlist.html#ga246925611ffa5d9a59489a1c0daf5473">inputlist::wreadin</a>.</p>

<p class="reference">Referenced by <a class="el" href="xspech_8f90.html#a9fdc71dffd7c61ee4588a3f80d3ab9ce">xspech()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="xspech_8f90_aec8c366a4e6a6f1cc611939d5d6e5c2c_icgraph.svg" width="1231" height="510"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a48f45478dc2c9f70ea8aa1c60ad06503" name="a48f45478dc2c9f70ea8aa1c60ad06503"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48f45478dc2c9f70ea8aa1c60ad06503">&#9670;&nbsp;</a></span>spec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spec</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is the main "driver" for the physics part of SPEC. </p>
<p >Picard iterations are performed (if in free-boundary mode) and within each Picard iteration, the fixed-boundary problem is solved (also iteratively). </p>
<p ><b>packing geometrical degrees-of-freedom into vector</b></p>
<ul>
<li>
If <code>NGdof.gt.0</code> , where <code>NGdof</code> counts the geometrical degrees-of-freedom, i.e. the \(R_{bc}\), \(Z_{bs}\), etc., then <a class="el" href="group__grp__packing.html#ga094e630c02686dd178749eb1efbf13fb" title="Packs, and unpacks, geometrical degrees of freedom; and sets coordinate axis.">packxi()</a> is called to "pack" the geometrical degrees-of-freedom into <code>position(0:NGdof)</code> .  </li>
</ul>
<p ><b>initialize adiabatic constants</b></p>
<ul>
<li>
If <code>Ladiabatic.eq.0</code> , then the "adiabatic constants" in each region, \(P_v\), are calculated as <p class="formulaDsp">
\begin{eqnarray} P_v \equiv p_v V_v^\gamma, \label{eq:adiabatic_xspech} \end{eqnarray}
</p>
 where \(p_v\equiv\,\)<code>pressure(vvol)</code> , the volume \(V_v\) of each region is computed by <a class="el" href="group__grp__volume.html#gae4c62d20b8fef07f4471b5b0889ab005" title="Computes volume of each region; and, if required, the derivatives of the volume with respect to the i...">volume()</a> , and the adiabatic index \(\gamma\equiv\,\)<code>gamma</code> .  </li>
</ul>
<p ><b>solving force-balance</b></p>
<ul>
<li>
If there are geometrical degress of freedom, i.e. if <code>NGdof.gt.0</code> , then <ul>
<li>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000013">Todo:</a></b></dt><dd>If <code>Lminimize.eq.1</code> , call <a class="el" href="group__grp__conjugate__gradient.html#ga25a3bae2ff2ee0469b045de0d033398b" title="Use preconditioned conjugate gradient method to find minimum of energy functional.">pc00aa()</a> to find minimum of energy functional using quasi-Newton, preconditioned conjugate gradient method, <code>E04DGF</code> </dd></dl>
<p class="endli"></p>
</li>
<li>
If <code>Lfindzero.gt.0</code> , call <a class="el" href="group__grp__force__driver.html#gaec14f81fbdbedafbc4189489ec8ae178" title="Employs Newton method to find , where  and  is defined in dforce() .">newton()</a> to find extremum of constrained energy functional using a Newton method, <code>C05PDF</code> .  </li>
</ul>
</li>
</ul>
<p ><b>post diagnostics</b></p>
<ul>
<li>
The pressure is computed from the adiabatic constants from Eqn. \((\ref{eq:adiabatic_xspech})\), i.e. \(p=P/V^\gamma\).  </li>
<li>
The Beltrami/vacuum fields in each region are re-calculated using <a class="el" href="group__grp__global__force.html#ga38c9d3c50bd043707fefa5137c9dbf44" title="Calculates , where  and , and .">dforce()</a> .  </li>
<li>
If <code>Lcheck.eq.5</code> <code></code>.or. <code>LHevalues</code> <code></code>.or. <code>LHevectors</code> <code></code>.or. <code>Lperturbed.eq.1</code> , then the force-gradient matrix is examined using <a class="el" href="group__grp__output.html#ga7401b50ec10c6598ee4a8112717a63ec" title="Computes eigenvalues and eigenvectors of derivative matrix,  and saves them to .ext....">hesian()</a> .  </li>
</ul>
<p ><b>free-boundary: re-computing normal field</b></p>
<ul>
<li>
If <code>Lfreebound.eq.1</code> and <code>Lfindzero.gt.0</code> and <code>mfreeits.ne.0</code> , then the magnetic field at the computational boundary produced by the plasma currents is computed using <a class="el" href="group__grp__free-boundary.html#gac0a2cc2241947b27241bb8ef75c5e0ed" title="Computes  on the computational boundary, .">bnorml()</a> .  </li>
<li>
The "new" magnetic field at the computational boundary produced by the plasma currents is updated using a Picard scheme: <p class="formulaDsp">
\begin{eqnarray} \texttt{Bns}_i^{j} = \lambda \, \texttt{Bns}_i^{j-1} + (1-\lambda) \texttt{Bns}_i, \label{eq:blending_xspech} \end{eqnarray}
</p>
 where \(j\) labels free-boundary iterations, the "blending parameter" is \(\lambda\equiv\,\)<code>gBnbld</code> , and <code>Bns</code> \(_i\) is computed by virtual casing. The subscript "$i$" labels Fourier harmonics.  </li>
<li>
If the new (unblended) normal field is <em>not</em> sufficiently close to the old normal field, as quantified by <code>gBntol</code> , then the free-boundary iterations continue. This is quantified by <p class="formulaDsp">
\begin{eqnarray} \sum_i | \texttt{Bns}_i^{j-1} - \texttt{Bns}_i | / N, \label{eq:gBntol_xspech} \end{eqnarray}
</p>
 where \(N\) is the total number of Fourier harmonics.  </li>
<li>
There are several choices that are available: <ul>
<li>
if <code>mfreeits=-2</code> : the vacuum magnetic field (really, the normal component of the field produced by the external currents at the computational boundary) required to hold the given equlibrium is written to file. This information is required as input by FOCUS <a class="el" href="citelist.html#CITEREF_y2017_zhu">[19]</a> for example. (This option probably needs to revised.)  </li>
<li>
if <code>mfreeits=-1</code> : after the plasma field is computed by virtual casing, the vacuum magnetic field is set to exactly balance the plasma field (again, we are really talking about the normal component at the computational boundary.) This will ensure that the computational boundary itself if a flux surface of the total magnetic field.  </li>
<li>
if <code>mfreeits=0</code> : the plasma field at the computational boundary is not updated; no "free-boundary" iterations take place.  </li>
<li>
if <code>mfreeits&gt;0</code> : the plasma field at the computational boundary is updated according to the above blending Eqn. \((\ref{eq:blending_xspech})\), and the free-boundary iterations will continue until either the tolerance condition is met (see <code>gBntol</code> and Eqn. \((\ref{eq:gBntol_xspech})\)) or the maximum number of free-boundary iterations, namely <code>mfreeits</code> , is reached. For this case, <code>Lzerovac</code> is relevant: if <code>Lzerovac=1</code> , then the vacuum field is set equal to the normal field at every iteration, which results in the computational boundary being a flux surface. (I am not sure if this is identical to setting <code>mfreeits=-1</code> ; the logic etc. needs to be revised.)  </li>
</ul>
</li>
</ul>
<p ><b>output files: vector potential</b></p>
<ul>
<li>
The vector potential is written to file using <a class="el" href="group__grp__output.html#ga08d6a254dbc3d9d40ff1cf0bdfdf2148" title="Writes vector potential to .ext.sp.A .">ra00aa()</a> .  </li>
</ul>

<p class="reference">References <a class="el" href="group__grp__global__physicslist.html#ga1b110ff3c17b7dac3af444ab9e42e3d2">inputlist::adiabatic</a>, <a class="el" href="group__grp__vecpot.html#ga430fa6f9a3ebb7a56185b72b8ea1ff49">allglobal::ate</a>, <a class="el" href="group__grp__vecpot.html#gaefec3203c02505c73b48dbb1c7ba96c1">allglobal::ato</a>, <a class="el" href="group__grp__vecpot.html#gad85df9e26321392291e0a43478da0f3c">allglobal::aze</a>, <a class="el" href="group__grp__vecpot.html#gad52dcff52cc620916d5e765051a0228a">allglobal::azo</a>, <a class="el" href="group__grp__force__constr.html#ga9ab71ed2b37abe0d8a4b90cb764ec6f6">allglobal::bbe</a>, <a class="el" href="group__grp__force__constr.html#gaa486c2bfc2562cdfae6583ff3332994a">allglobal::bbo</a>, <a class="el" href="namespaceallglobal.html#a62b3d756309401ae5638d238084719ce">allglobal::beltramierror</a>, <a class="el" href="group__grp__free-boundary.html#gac0a2cc2241947b27241bb8ef75c5e0ed">bnorml()</a>, <a class="el" href="namespaceallglobal.html#a4aae78647d8321706bee7245015e904f">allglobal::bnserr</a>, <a class="el" href="group__grp__fourier__transform.html#ga77de10a2effb1f42cde73eccb9739ba9">allglobal::cfmn</a>, <a class="el" href="namespaceallglobal.html#afae71b580d9f9c71a6796207a5411959">allglobal::cpus</a>, <a class="el" href="group__grp__global__force.html#ga38c9d3c50bd043707fefa5137c9dbf44">dforce()</a>, <a class="el" href="group__grp__field__matrices.html#ga7ba9a10f7e3aae1886343b313991d49e">allglobal::dma</a>, <a class="el" href="group__grp__field__matrices.html#ga5325a38319ac050c38a431eef2e94473">allglobal::dmb</a>, <a class="el" href="group__grp__field__matrices.html#gaebd4ae71765f8b5cc312e963a122140f">allglobal::dmd</a>, <a class="el" href="group__grp__field__matrices.html#gabf45dbde867eb2274ba00f920094adc7">allglobal::dmg</a>, <a class="el" href="group__grp__chebychev__metric.html#ga4540124e238e2868f80f825ce7b20514">allglobal::dpflux</a>, <a class="el" href="group__grp__chebychev__metric.html#gafa161af8102abf0cdabb933bc799ddc4">allglobal::dtflux</a>, <a class="el" href="group__grp__fourier__transform.html#ga8c1126783337bb324fe747f00104749e">allglobal::efmn</a>, <a class="el" href="group__grp__misc.html#ga948dcbb5cd2eda2c5f4588b61fa3346c">allglobal::first_free_bound</a>, <a class="el" href="namespaceallglobal.html#a553a5d9f7253b80750db5131b7e5ffef">allglobal::forceerr</a>, <a class="el" href="group__grp__global__physicslist.html#ga778f38f46639ce987228193dbc29626d">inputlist::gamma</a>, <a class="el" href="group__grp__global__global.html#ga8ee4cd7ee59ab34c0b7b1c87ca98cd7e">inputlist::gbnbld</a>, <a class="el" href="group__grp__global__global.html#ga70cca5731c42473a24ab5b3db73f10b4">inputlist::gbntol</a>, <a class="el" href="group__grp__global__physicslist.html#ga46c6c39acda26e483cb0902fabbd8156">inputlist::helicity</a>, <a class="el" href="group__grp__output.html#ga7401b50ec10c6598ee4a8112717a63ec">hesian()</a>, <a class="el" href="group__grp__iface__geom.html#gaa5c3bcffd4f21074dd5a496a63489737">allglobal::ibnc</a>, <a class="el" href="group__grp__iface__geom.html#ga9a4fe7e982a7490f6074dd4698c869d6">allglobal::ibns</a>, <a class="el" href="group__grp__global__physicslist.html#gaa6dcbfd2f5cb5f23f4bc567fb13ae0e2">inputlist::igeometry</a>, <a class="el" href="group__grp__force__constr.html#ga44b2218b080a987eae2e94cb9cbd55bc">allglobal::iie</a>, <a class="el" href="group__grp__force__constr.html#gad98c0d01fe52d8263c443b938d73e6a1">allglobal::iio</a>, <a class="el" href="group__grp__fourier__repr.html#gaeac30068003c58add7893688ea2e48aa">allglobal::im</a>, <a class="el" href="namespaceallglobal.html#aab85bb56a63bab25adf4999d7e7efad2">allglobal::imagneticok</a>, <a class="el" href="group__grp__fourier__repr.html#gae946717d1654463c7cb4b1d7fd712f7d">allglobal::in</a>, <a class="el" href="group__grp__iface__geom.html#ga9f6e014546551429956a2a47c134d07b">allglobal::irbc</a>, <a class="el" href="group__grp__iface__geom.html#ga05ba18442623cf5f34f7a2193a03e0b1">allglobal::irbs</a>, <a class="el" href="group__grp__global__physicslist.html#ga6101a320f6577fdbc320f6a33f82ee90">inputlist::isurf</a>, <a class="el" href="group__grp__iface__geom.html#ga2090710c425371738a7802b5d044ef04">allglobal::ivnc</a>, <a class="el" href="group__grp__iface__geom.html#ga026d4427227376a01e0515e55f15d7f6">allglobal::ivns</a>, <a class="el" href="group__grp__global__physicslist.html#gae5aba6f12ca82ce11c2a577102c64820">inputlist::ivolume</a>, <a class="el" href="group__grp__iface__geom.html#ga6c7ad3b18081227f992e4c3e73a2e216">allglobal::izbc</a>, <a class="el" href="group__grp__iface__geom.html#gadcc12f5e32287fd4b60dc01afc6e64d2">allglobal::izbs</a>, <a class="el" href="group__grp__global__physicslist.html#ga2a9aa5fda4787ae756c3216be559e743">inputlist::ladiabatic</a>, <a class="el" href="group__grp__global__numerics.html#gac41753e047cd8a3a5c5640ba239758e8">inputlist::lautoinitbn</a>, <a class="el" href="group__grp__global__diagnostics.html#ga9bd118017d70e35d658a10463ab4c1dc">inputlist::lcheck</a>, <a class="el" href="group__grp__global__physicslist.html#gafa9685795dd6029e20fc50e564b78018">inputlist::lconstraint</a>, <a class="el" href="group__grp__vecpot.html#gad6a2a40a248c2d81155a94b2dfe9b480">allglobal::lcoordinatesingularity</a>, <a class="el" href="group__grp__global__global.html#ga28b1d8d67e6902726c87fe0785c1634e">inputlist::lfindzero</a>, <a class="el" href="group__grp__global__physicslist.html#ga1b86a8de5a6a81fe5524d6e23068813e">inputlist::lfreebound</a>, <a class="el" href="group__grp__geomdof.html#gab2eef4b8dd04b0b4067549773704dad3">allglobal::lgdof</a>, <a class="el" href="group__grp__global__diagnostics.html#ga1ffbe726af9975df667836574dc421e7">inputlist::lhevalues</a>, <a class="el" href="group__grp__global__diagnostics.html#ga3b561efdb5e6ef16d8b19c1e8cc3b778">inputlist::lhevectors</a>, <a class="el" href="group__grp__global__diagnostics.html#gae577c62c326c41415e156c47d4c25254">inputlist::lhmatrix</a>, <a class="el" href="namespacenumerical.html#a908d0d7739e83c52ceccf02036061290">numerical::logtolerance</a>, <a class="el" href="group__grp__global__diagnostics.html#gaf5f29c4832896ed0a163c214132d2aa2">inputlist::lperturbed</a>, <a class="el" href="group__grp__vecpot.html#gabec56b2849c2ea1b35bf0503d373d849">allglobal::lplasmaregion</a>, <a class="el" href="group__grp__global__physicslist.html#ga1509b6ce73e909b86beaf65c26527932">inputlist::lrad</a>, <a class="el" href="namespacefileunits.html#ab1d6a5c5fad6cd97aa3b008d98f12609">fileunits::lunit</a>, <a class="el" href="group__grp__vecpot.html#ga1f7f9baf38f833eb5f5318408c5407ac">allglobal::lvacuumregion</a>, <a class="el" href="group__grp__global__numerics.html#ga25c24200f09c2dcb39957f3a8bc71742">inputlist::lzerovac</a>, <a class="el" href="group__grp__field__matrices.html#ga8eeebba442839ee1d13bf6a5748943c8">allglobal::mbpsi</a>, <a class="el" href="group__grp__global__global.html#ga10b2732b4273e84e78e7768d965e7436">inputlist::mfreeits</a>, <a class="el" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400">allglobal::mn</a>, <a class="el" href="namespaceallglobal.html#a2382df770fc57cc53ed68c6e1ac23819">allglobal::mpi_comm_spec</a>, <a class="el" href="group__grp__global__physicslist.html#ga434a83d47ab8804a8c88e9e09f194bf2">inputlist::mu</a>, <a class="el" href="namespaceconstants.html#af676ae9761396d6b62ff9a752d8db4ab">constants::mu0</a>, <a class="el" href="namespaceallglobal.html#aa2a4850f9468d817a673c1ef7f718849">allglobal::mvol</a>, <a class="el" href="namespaceallglobal.html#aca1163f9aab48251a99d00e63618cc39">allglobal::myid</a>, <a class="el" href="namespaceallglobal.html#aa45097c36006ab1ffc0cb06a927ed02a">allglobal::ncpu</a>, <a class="el" href="group__grp__force__driver.html#gaec14f81fbdbedafbc4189489ec8ae178">newton()</a>, <a class="el" href="group__grp__global__physicslist.html#gae071c5738f7f7a6ada9d6b66676e37c7">inputlist::nfp</a>, <a class="el" href="group__grp__misc.html#ga86dc32e10abadf652ab2c6617696f2cd">allglobal::nfreeboundaryiterations</a>, <a class="el" href="group__grp__geomdof.html#gaa324d27af16a3e8841990f86baca252c">allglobal::ngdof</a>, <a class="el" href="namespaceallglobal.html#a6993aa662f74b327357896c7d9c81f4b">allglobal::notstellsym</a>, <a class="el" href="group__grp__global__diagnostics.html#ga1352151a16c55ca06c613474753e4acc">inputlist::nppts</a>, <a class="el" href="group__grp__global__diagnostics.html#ga43f97d12fb946e52880568090f5ebf88">inputlist::nptrj</a>, <a class="el" href="group__grp__fourier__transform.html#ga369408d2dce5e4b64b7bf73699367b32">allglobal::ntz</a>, <a class="el" href="group__grp__global__physicslist.html#gafdbe1fac5fd98bb41ae5cc363ab9aedd">inputlist::nvol</a>, <a class="el" href="group__grp__global__diagnostics.html#ga62fe17fdae41361dfa29f54c02a80947">inputlist::odetol</a>, <a class="el" href="group__grp__fourier__transform.html#gaedb347c6ba031b77ee637a09b6d7aff7">allglobal::ofmn</a>, <a class="el" href="namespaceconstants.html#ad5224c0b5e13bf12b18dafbb62ba4e8d">constants::one</a>, <a class="el" href="namespacefileunits.html#a7463305b9ff5b4b659d87f6fa59f74a7">fileunits::ounit</a>, <a class="el" href="group__grp__packing.html#ga094e630c02686dd178749eb1efbf13fb">packxi()</a>, <a class="el" href="group__grp__global__physicslist.html#ga1d7cc174857156ba5e880eddbe25b65b">inputlist::pflux</a>, <a class="el" href="group__grp__global__physicslist.html#ga31b9257e6356b1591fbc63e618c74c2b">inputlist::phiedge</a>, <a class="el" href="namespaceconstants.html#a4fad0dab629c84331119053f1ec1348d">constants::pi2</a>, <a class="el" href="group__grp__global__physicslist.html#ga1bec66b8a5f59fee9529ca04eb29202a">inputlist::pressure</a>, <a class="el" href="group__grp__global__physicslist.html#ga89fd8fbe67af2b8e72dbcb9440c7b797">inputlist::pscale</a>, <a class="el" href="group__grp__output.html#ga08d6a254dbc3d9d40ff1cf0bdfdf2148">ra00aa()</a>, <a class="el" href="group__grp__global__physicslist.html#ga82c7ae2283ae9fc8d8a6e23ce1d3f696">inputlist::rbc</a>, <a class="el" href="group__grp__global__physicslist.html#gaae55325d404aa5088957b91085763ddb">inputlist::rbs</a>, <a class="el" href="group__grp__fourier__transform.html#ga45e62efd92657124df197ceac8133393">allglobal::sfmn</a>, <a class="el" href="group__grp__field__matrices.html#ga8d8e425308b9103e03d3f17df8dac68a">allglobal::solution</a>, <a class="el" href="group__grp__global__physicslist.html#ga5616f18d1b18821a3f6ce6542a0d53d0">inputlist::tflux</a>, <a class="el" href="group__grp__global__global.html#ga02f23f7f95485f63c4ab9c8c14669cd3">inputlist::vcasingtol</a>, <a class="el" href="namespaceconstants.html#ab5ebe01a9a55e38143872c4b112e41aa">constants::version</a>, <a class="el" href="group__grp__volume.html#gae4c62d20b8fef07f4471b5b0889ab005">volume()</a>, <a class="el" href="namespacenumerical.html#a37691ec078f21840c475c4c7b83d7d31">numerical::vsmall</a>, <a class="el" href="group__grp__volints.html#ga8f3eaacd48bc30ec4332e1216213089f">allglobal::vvolume</a>, <a class="el" href="group__grp__global__screenlist.html#gaef361ceee97e08e5f134227903265494">inputlist::wmacros</a>, <a class="el" href="group__grp__output.html#ga282c297c96abdab5e76b5ace440b09a8">allglobal::wrtend()</a>, <a class="el" href="xspech_8f90.html#a9fdc71dffd7c61ee4588a3f80d3ab9ce">xspech()</a>, <a class="el" href="namespaceallglobal.html#a1f4ddb89b3246fef8d73c88b730eda3a">allglobal::yesstellsym</a>, <a class="el" href="group__grp__global__physicslist.html#gaa5c20328ddf092f3e8c48f5591bdb7e1">inputlist::zbc</a>, <a class="el" href="group__grp__global__physicslist.html#gab1fba948fc7acbbdf91c00cc91efb30d">inputlist::zbs</a>, and <a class="el" href="namespaceconstants.html#ab2b0340319f61089513f5dd1d3971a47">constants::zero</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__grp__global__force.html#ga38c9d3c50bd043707fefa5137c9dbf44">dforce()</a>, <a class="el" href="group__grp__output.html#ga0f962c09cd5d5eba99f1cba043cb3898">sphdf5::init_outfile()</a>, and <a class="el" href="xspech_8f90.html#a9fdc71dffd7c61ee4588a3f80d3ab9ce">xspech()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="xspech_8f90_a48f45478dc2c9f70ea8aa1c60ad06503_cgraph.svg" width="2460" height="2863"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="xspech_8f90_a48f45478dc2c9f70ea8aa1c60ad06503_icgraph.svg" width="862" height="608"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a1451823a7b97101a797de616250752c1" name="a1451823a7b97101a797de616250752c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1451823a7b97101a797de616250752c1">&#9670;&nbsp;</a></span>final_diagnostics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine final_diagnostics</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Final diagnostics. </p>
<ul>
<li>
sc00aa() is called to compute the covariant components of the magnetic field at the interfaces; these are related to the singular currents  </li>
<li>
if <code>Lcheck=1</code> , <a class="el" href="group__grp__diagnostics.html#ga6411205c36a7d50002d7f3fb3133c441" title="Measures error in Beltrami equation, .">jo00aa()</a> is called to compute the error in the Beltrami equation  </li>
<li>
<a class="el" href="group__grp__diagnostics.html#gad67931244268a09bd077dae8910c7096" title="Constructs PoincarÃ© plot and &quot;approximate&quot; rotational-transform (driver).">pp00aa()</a> is called to construct the Poincare plot by field-line following.  </li>
</ul>

<p class="reference">References <a class="el" href="namespaceallglobal.html#a62b3d756309401ae5638d238084719ce">allglobal::beltramierror</a>, <a class="el" href="group__grp__parallel.html#ga5d8e3412e023967dda67b02f358b754a">brcast()</a>, <a class="el" href="group__grp__covar__field__ifaces.html#ga1f5ea9c38e55707a900ca335990b63f1">allglobal::btemn</a>, <a class="el" href="group__grp__covar__field__ifaces.html#ga81924a77513f01a3ab914cc6d87c9558">allglobal::btomn</a>, <a class="el" href="group__grp__covar__field__ifaces.html#ga01aa29d7089eccad444e36b93b3d0784">allglobal::bzemn</a>, <a class="el" href="group__grp__covar__field__ifaces.html#ga2db512f2492084aac27af4378441be37">allglobal::bzomn</a>, <a class="el" href="group__grp__fourier__transform.html#ga77de10a2effb1f42cde73eccb9739ba9">allglobal::cfmn</a>, <a class="el" href="namespaceallglobal.html#afae71b580d9f9c71a6796207a5411959">allglobal::cpus</a>, <a class="el" href="group__grp__field__matrices.html#ga3299c8b558ec492548e1a5d9e441c6d3">allglobal::diotadxup</a>, <a class="el" href="group__grp__chebychev__metric.html#gafa161af8102abf0cdabb933bc799ddc4">allglobal::dtflux</a>, <a class="el" href="group__grp__fourier__transform.html#ga8c1126783337bb324fe747f00104749e">allglobal::efmn</a>, <a class="el" href="group__grp__global__physicslist.html#gaa6dcbfd2f5cb5f23f4bc567fb13ae0e2">inputlist::igeometry</a>, <a class="el" href="namespaceallglobal.html#aab85bb56a63bab25adf4999d7e7efad2">allglobal::imagneticok</a>, <a class="el" href="group__grp__int__global.html#gadd48d73d6a0417d9f1c05052570202cd">allglobal::iquad</a>, <a class="el" href="namespaceallglobal.html#aea1f5a74462533337cb950b8d7486b25">allglobal::ismyvolume()</a>, <a class="el" href="namespaceallglobal.html#a8c51adb4a77729ad6f26206da69fc105">allglobal::ismyvolumevalue</a>, <a class="el" href="group__grp__global__physicslist.html#ga6101a320f6577fdbc320f6a33f82ee90">inputlist::isurf</a>, <a class="el" href="group__grp__global__physicslist.html#gae5aba6f12ca82ce11c2a577102c64820">inputlist::ivolume</a>, <a class="el" href="group__grp__diagnostics.html#ga6411205c36a7d50002d7f3fb3133c441">jo00aa()</a>, <a class="el" href="group__grp__global__diagnostics.html#ga9bd118017d70e35d658a10463ab4c1dc">inputlist::lcheck</a>, <a class="el" href="group__grp__vecpot.html#gad6a2a40a248c2d81155a94b2dfe9b480">allglobal::lcoordinatesingularity</a>, <a class="el" href="group__grp__field__matrices.html#ga9a50861390cbd5e6dab0378e56377d93">allglobal::lmns</a>, <a class="el" href="group__grp__vecpot.html#gabec56b2849c2ea1b35bf0503d373d849">allglobal::lplasmaregion</a>, <a class="el" href="group__grp__global__numerics.html#gac6b78d4cc8e0a2b1cf22f54bfedef9fa">inputlist::lsvdiota</a>, <a class="el" href="group__grp__global__diagnostics.html#gab49430984a262fca5e90ad7d69b3acf4">inputlist::ltransform</a>, <a class="el" href="group__grp__vecpot.html#ga1f7f9baf38f833eb5f5318408c5407ac">allglobal::lvacuumregion</a>, <a class="el" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400">allglobal::mn</a>, <a class="el" href="namespaceallglobal.html#a2382df770fc57cc53ed68c6e1ac23819">allglobal::mpi_comm_spec</a>, <a class="el" href="group__grp__global__physicslist.html#ga434a83d47ab8804a8c88e9e09f194bf2">inputlist::mu</a>, <a class="el" href="namespaceallglobal.html#aa2a4850f9468d817a673c1ef7f718849">allglobal::mvol</a>, <a class="el" href="namespaceallglobal.html#aca1163f9aab48251a99d00e63618cc39">allglobal::myid</a>, <a class="el" href="namespaceallglobal.html#aa45097c36006ab1ffc0cb06a927ed02a">allglobal::ncpu</a>, <a class="el" href="group__grp__global__diagnostics.html#ga1352151a16c55ca06c613474753e4acc">inputlist::nppts</a>, <a class="el" href="group__grp__global__diagnostics.html#ga43f97d12fb946e52880568090f5ebf88">inputlist::nptrj</a>, <a class="el" href="group__grp__fourier__transform.html#ga2a7d2dbc4637d792e1eeabcd4ee5564e">allglobal::nt</a>, <a class="el" href="group__grp__fourier__transform.html#ga369408d2dce5e4b64b7bf73699367b32">allglobal::ntz</a>, <a class="el" href="group__grp__global__physicslist.html#gafdbe1fac5fd98bb41ae5cc363ab9aedd">inputlist::nvol</a>, <a class="el" href="group__grp__fourier__transform.html#gaa91566c55f28df38e46ffc19e60f766f">allglobal::nz</a>, <a class="el" href="group__grp__global__diagnostics.html#ga62fe17fdae41361dfa29f54c02a80947">inputlist::odetol</a>, <a class="el" href="group__grp__fourier__transform.html#gaedb347c6ba031b77ee637a09b6d7aff7">allglobal::ofmn</a>, <a class="el" href="namespaceconstants.html#ad5224c0b5e13bf12b18dafbb62ba4e8d">constants::one</a>, <a class="el" href="namespacefileunits.html#a7463305b9ff5b4b659d87f6fa59f74a7">fileunits::ounit</a>, <a class="el" href="namespaceconstants.html#a4fad0dab629c84331119053f1ec1348d">constants::pi2</a>, <a class="el" href="group__grp__diagnostics.html#gad67931244268a09bd077dae8910c7096">pp00aa()</a>, <a class="el" href="group__grp__fourier__transform.html#ga45e62efd92657124df197ceac8133393">allglobal::sfmn</a>, <a class="el" href="group__grp__transform.html#ga0e0447653b8da82f06748dd8831bc337">tr00ab()</a>, <a class="el" href="group__grp__volume.html#gae4c62d20b8fef07f4471b5b0889ab005">volume()</a>, <a class="el" href="namespaceallglobal.html#ad2dbd21d0579d623a92119c5ab553c7c">allglobal::whichcpuid()</a>, <a class="el" href="group__grp__global__screenlist.html#gaef361ceee97e08e5f134227903265494">inputlist::wmacros</a>, <a class="el" href="xspech_8f90.html#a9fdc71dffd7c61ee4588a3f80d3ab9ce">xspech()</a>, and <a class="el" href="namespaceconstants.html#ab2b0340319f61089513f5dd1d3971a47">constants::zero</a>.</p>

<p class="reference">Referenced by <a class="el" href="xspech_8f90.html#a9fdc71dffd7c61ee4588a3f80d3ab9ce">xspech()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="xspech_8f90_a1451823a7b97101a797de616250752c1_cgraph.svg" width="2478" height="2827"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="xspech_8f90_a1451823a7b97101a797de616250752c1_icgraph.svg" width="1174" height="499"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="xspech_8f90.html">xspech.f90</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
