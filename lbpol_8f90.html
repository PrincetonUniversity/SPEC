<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SPEC: lbpol.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
<script>
window.MathJax = {
  loader: {
    load: ['[tex]/color', '[tex]/cancel']
  },
  tex: {
      tags: "ams",
      packages: {'[+]': ['noerrors'],
                 '[+]': ['color'],
                 '[+]': ['verb'],
                 '[+]': ['cancel']
      }
      macros: { bm: ["{\\boldsymbol #1}",1]
      }
  }
};
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" id="MathJax-script"></script>
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.0.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="SPEC_97x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SPEC
   &#160;<span id="projectnumber">3.00</span>
   </div>
   <div id="projectbrief">Stepped Pressure Equilibrium Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('lbpol_8f90.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">lbpol.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Computes \(B_{\theta,e,0,0}\) at the interface.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a29ae6196c664f390d0e60ab7916c806b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lbpol_8f90.html#a29ae6196c664f390d0e60ab7916c806b">lbpol</a> (lvol, Bt00, ideriv, iocons)</td></tr>
<tr class="separator:a29ae6196c664f390d0e60ab7916c806b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Computes \(B_{\theta,e,0,0}\) at the interface. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lvol</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Bt00</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ideriv</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iocons</td><td></td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a29ae6196c664f390d0e60ab7916c806b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29ae6196c664f390d0e60ab7916c806b">&#9670;&nbsp;</a></span>lbpol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lbpol </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lvol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(1:mvol, 0:1, -1:2), intent(inout)&#160;</td>
          <td class="paramname"><em>Bt00</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ideriv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iocons</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ideriv</td><td>lbpol will return \(B_{\theta,e,0,0}\) (0) or its derivative with respect to the geometry (-1), mu (1) or the poloidal flux (2). \(\mbox{ideriv}\in\{-1,\ldots,2\} \)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lvol</td><td>Volume index. \(\mbox{lvol}\in\{1,\ldots,\mbox{Mvol}\} \)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iocons</td><td>\(B_{\theta,e,0,0}\) is evaluated on the inner (iocons=0) or outer (iocons=1) volume boundary. \(\mbox{iocons}\in\{0,1\} \)</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bt00</td><td>\(B_{\theta,e,0,0}\), with indices Bt00( lvol, iocons, ideriv ). </td></tr>
  </table>
  </dd>
</dl>
<p>Computes \(B_{\theta,e,0,0}\) at the volume interfaces. This is used by dfp100 to evaluate the toroidal current at the volume interfaces, and by dfp200 to construct the force gradient when the current constraint (Lconstraint=3) is used. This is also used by xspech to compute the toroidal current at the volume interfaces, written in the output. </p><ol>
<li>
<p class="startli">Call <a class="el" href="group__grp__geometry.html#gaaca20aa60eaf39055f3c9d5c02a24ac2" title="Calculates coordinates, , and metrics, using FFTs.">coords()</a> to compute the metric coefficients and the jacobian. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Build coefficients efmn, ofmn, cfmn, sfmn from the field vector potential Ate, Ato, Aze and Azo, and radial derivatives of the polynomial basis TT(ll,innout,1). These variables are the derivatives with respect to s of the magnetic field vector potential in Fourier space. If ideriv \(\neq 0\), construct the relevant derivatives of the vector potential. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Take the inverse Fourier transform of efmn, ofmn, cfmn, sfmn. These are the covariant components of \(\frac{\partial A}{\partial s}\), <em>i.e.</em> the contravariant components of \(\mathbf{B}\). </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Build covariant components of the field using the metric coefficients guvij and the jacobian sg. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">If ideriv=-1 (derivatives with respect to the geometry), need to add derivatives relative to the metric elements </p>
<ol>
<li>
<p class="startli">Get derivatives of metric element by calling <a class="el" href="group__grp__geometry.html#gaaca20aa60eaf39055f3c9d5c02a24ac2" title="Calculates coordinates, , and metrics, using FFTs.">coords()</a> </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Compute vector potential without taking any derivatives </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Add to \(\frac{\partial B_\theta}{\partial x_i}\) the contributions from \( \frac{\partial}{\partial x_i} \frac{g_{\mu\nu}}{\sqrt{g}} \)</p>
<p class="endli"></p>
</li>
</ol>
<p class="endli"></p>
</li>
<li>
<p class="startli">Fourier transform the field and store it in the variables efmn, ofmn, cfmn and sfmn. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Save first even fourier mode into Bt00( lvol, iocons, ideriv ) </p>
<p class="endli"></p>
</li>
</ol>

<p class="reference">References <a class="el" href="group__grp__vecpot.html#ga430fa6f9a3ebb7a56185b72b8ea1ff49">allglobal::ate</a>, <a class="el" href="group__grp__vecpot.html#gaefec3203c02505c73b48dbb1c7ba96c1">allglobal::ato</a>, <a class="el" href="group__grp__vecpot.html#gad85df9e26321392291e0a43478da0f3c">allglobal::aze</a>, <a class="el" href="group__grp__vecpot.html#gad52dcff52cc620916d5e765051a0228a">allglobal::azo</a>, <a class="el" href="group__grp__fourier__transform.html#ga77de10a2effb1f42cde73eccb9739ba9">allglobal::cfmn</a>, <a class="el" href="group__grp__fourier__transform.html#gae1ccb61fefa1682f6e43b8d05ad75bd4">allglobal::comn</a>, <a class="el" href="group__grp__geometry.html#gaaca20aa60eaf39055f3c9d5c02a24ac2">coords()</a>, <a class="el" href="group__grp__global.html#gafae71b580d9f9c71a6796207a5411959">allglobal::cpus</a>, <a class="el" href="group__grp__internal__vars.html#ga82860515fc41c25b7e0d1b88505b6592">allglobal::dbdx</a>, <a class="el" href="group__grp__fourier__transform.html#ga8c1126783337bb324fe747f00104749e">allglobal::efmn</a>, <a class="el" href="group__grp__fourier__transform.html#ga03a90b1d4526190ab22932237d612316">allglobal::evmn</a>, <a class="el" href="group__grp__fourier__transform.html#ga0111c19dc8a8bbde00b38606f9df1c88">allglobal::guvij</a>, <a class="el" href="namespaceconstants.html#a28ec2b391ac319cee0f31bb295b89cc2">constants::half</a>, <a class="el" href="group__grp__global__physicslist.html#gaa6dcbfd2f5cb5f23f4bc567fb13ae0e2">inputlist::igeometry</a>, <a class="el" href="group__grp__fourier__repr.html#gaeac30068003c58add7893688ea2e48aa">allglobal::im</a>, <a class="el" href="group__grp__enh__res__metr.html#gac80ba4fc5afa4d51083e4d7eadc6dfc0">allglobal::ime</a>, <a class="el" href="group__grp__fourier__repr.html#gae946717d1654463c7cb4b1d7fd712f7d">allglobal::in</a>, <a class="el" href="group__grp__enh__res__metr.html#gaa2fc20040ad5a9e50feabacf946a45c4">allglobal::ine</a>, <a class="el" href="group__grp__numerics.html#ga1fd52accb0646f535f9bcc46cf5a68f3">invfft()</a>, <a class="el" href="group__grp__global__diagnostics.html#ga9bd118017d70e35d658a10463ab4c1dc">inputlist::lcheck</a>, <a class="el" href="group__grp__vecpot.html#gad6a2a40a248c2d81155a94b2dfe9b480">allglobal::lcoordinatesingularity</a>, <a class="el" href="group__grp__global__physicslist.html#ga1509b6ce73e909b86beaf65c26527932">inputlist::lrad</a>, <a class="el" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400">allglobal::mn</a>, <a class="el" href="group__grp__enh__res__metr.html#ga890b21465dcf8318dcd977ddd481ae11">allglobal::mne</a>, <a class="el" href="namespaceconstants.html#af676ae9761396d6b62ff9a752d8db4ab">constants::mu0</a>, <a class="el" href="group__grp__global.html#gaa2a4850f9468d817a673c1ef7f718849">allglobal::mvol</a>, <a class="el" href="namespaceallglobal.html#aca1163f9aab48251a99d00e63618cc39">allglobal::myid</a>, <a class="el" href="group__grp__global.html#ga6993aa662f74b327357896c7d9c81f4b">allglobal::notstellsym</a>, <a class="el" href="group__grp__fourier__transform.html#ga2a7d2dbc4637d792e1eeabcd4ee5564e">allglobal::nt</a>, <a class="el" href="group__grp__fourier__transform.html#ga369408d2dce5e4b64b7bf73699367b32">allglobal::ntz</a>, <a class="el" href="group__grp__fourier__transform.html#gaa91566c55f28df38e46ffc19e60f766f">allglobal::nz</a>, <a class="el" href="group__grp__fourier__transform.html#gaebdaefaf68008cc122895a223c69a3a8">allglobal::odmn</a>, <a class="el" href="group__grp__fourier__transform.html#gaedb347c6ba031b77ee637a09b6d7aff7">allglobal::ofmn</a>, <a class="el" href="namespaceconstants.html#ad5224c0b5e13bf12b18dafbb62ba4e8d">constants::one</a>, <a class="el" href="namespacefileunits.html#a7463305b9ff5b4b659d87f6fa59f74a7">fileunits::ounit</a>, <a class="el" href="namespaceconstants.html#a815ad954ef712211ed1b1fdb8be42487">constants::pi</a>, <a class="el" href="namespaceconstants.html#a4fad0dab629c84331119053f1ec1348d">constants::pi2</a>, <a class="el" href="group__grp__fourier__repr.html#ga9a3040af9af01340bb79b58e53956a50">allglobal::regumm</a>, <a class="el" href="group__grp__fourier__transform.html#ga45e62efd92657124df197ceac8133393">allglobal::sfmn</a>, <a class="el" href="group__grp__fourier__transform.html#ga4b1c60e25eab68b6372bf28f84aecc97">allglobal::sg</a>, <a class="el" href="group__grp__fourier__transform.html#gaefb7a462fa8aafa9cb735e81f4152784">allglobal::simn</a>, <a class="el" href="group__grp__numerics.html#ga041138109a57e651c57117bb4180409e">tfft()</a>, <a class="el" href="group__grp__global.html#ga0ff41ecfbb162f4712030c7806852615">allglobal::tt</a>, <a class="el" href="namespaceconstants.html#a77f9c93617de9c40ab41a50a157fb90d">constants::two</a>, <a class="el" href="group__grp__global.html#ga1f4ddb89b3246fef8d73c88b730eda3a">allglobal::yesstellsym</a>, and <a class="el" href="namespaceconstants.html#ab2b0340319f61089513f5dd1d3971a47">constants::zero</a>.</p>

<p class="reference">Referenced by <a class="el" href="dfp100_8f90.html#a17a3ac15cc83994394f7b4cc05e5898e">dfp100()</a>, <a class="el" href="dfp200_8f90.html#a73ddf39ecc5228201fb643779e17cd36">evaluate_dmupfdx()</a>, and <a class="el" href="xspech_8f90.html#aea782eae089760a491c2c54f9903abcc">xspech()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="lbpol_8f90_a29ae6196c664f390d0e60ab7916c806b_cgraph.svg" width="282" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="lbpol_8f90_a29ae6196c664f390d0e60ab7916c806b_icgraph.svg" width="1023" height="656"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="lbpol_8f90.html">lbpol.f90</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
