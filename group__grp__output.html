<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SPEC: Output file(s)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  },
  tex: {
    macros: {},
    packages: ['base','configmacros','amsmath','amssymb']
  }
};
window.MathJax = {
  loader: {
    load: ['[tex]/color', '[tex]/cancel']
  },
  tex: {
      tags: 'ams',
      packages: {'[+]': ['noerrors'],
                 '[+]': ['color'],
                 '[+]': ['verb'],
                 '[+]': ['cancel']
      },
      macros: { bm: ['{\\boldsymbol #1}',1]
      }
  }
};
// https://docs.mathjax.org/en/latest/web/configuration.html#configuring-and-loading-in-one-script
//(function () {
//  var script = document.createElement('script');
//  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js';
//  script.async = true;
//  document.head.appendChild(script);
//})();
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="SPEC_97x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SPEC<span id="projectnumber">&#160;3.20</span>
   </div>
   <div id="projectbrief">Stepped Pressure Equilibrium Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__grp__output.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">Output file(s)</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacesphdf5"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesphdf5.html">sphdf5</a></td></tr>
<tr class="memdesc:namespacesphdf5"><td class="mdescLeft">&#160;</td><td class="mdescRight">writing the HDF5 output file <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ga282c297c96abdab5e76b5ace440b09a8"><td class="memItemLeft" align="right" valign="top"><a id="ga282c297c96abdab5e76b5ace440b09a8" name="ga282c297c96abdab5e76b5ace440b09a8"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><b>allglobal::wrtend</b></td></tr>
<tr class="memdesc:ga282c297c96abdab5e76b5ace440b09a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the restart file <code>ext.sp.end</code>. <br /></td></tr>
<tr class="separator:ga282c297c96abdab5e76b5ace440b09a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7401b50ec10c6598ee4a8112717a63ec"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__grp__output.html#ga7401b50ec10c6598ee4a8112717a63ec">hesian</a> (NGdof, position, Mvol, mn, LGdof)</td></tr>
<tr class="memdesc:ga7401b50ec10c6598ee4a8112717a63ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes eigenvalues and eigenvectors of derivative matrix, \(\nabla_{\bf xi}{\bf F}\) and saves them to <code></code>.ext.GF.ev and <code></code>.ext.GF.ma.  <a href="group__grp__output.html#ga7401b50ec10c6598ee4a8112717a63ec">More...</a><br /></td></tr>
<tr class="separator:ga7401b50ec10c6598ee4a8112717a63ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga382822b303cbf8c56d6f54dcb379caf2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__grp__output.html#ga382822b303cbf8c56d6f54dcb379caf2">writereadgf</a> (readorwrite, NGdof, ireadhessian)</td></tr>
<tr class="memdesc:ga382822b303cbf8c56d6f54dcb379caf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">read or write force-derivative matrix <code></code>.ext.sp.DF  <a href="group__grp__output.html#ga382822b303cbf8c56d6f54dcb379caf2">More...</a><br /></td></tr>
<tr class="separator:ga382822b303cbf8c56d6f54dcb379caf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga08d6a254dbc3d9d40ff1cf0bdfdf2148"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__grp__output.html#ga08d6a254dbc3d9d40ff1cf0bdfdf2148">ra00aa</a> (writeorread)</td></tr>
<tr class="memdesc:ga08d6a254dbc3d9d40ff1cf0bdfdf2148"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes vector potential to <code></code>.ext.sp.A .  <a href="group__grp__output.html#ga08d6a254dbc3d9d40ff1cf0bdfdf2148">More...</a><br /></td></tr>
<tr class="separator:ga08d6a254dbc3d9d40ff1cf0bdfdf2148"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0f962c09cd5d5eba99f1cba043cb3898"><td class="memItemLeft" align="right" valign="top"><a id="ga0f962c09cd5d5eba99f1cba043cb3898" name="ga0f962c09cd5d5eba99f1cba043cb3898"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><b>sphdf5::init_outfile</b></td></tr>
<tr class="memdesc:ga0f962c09cd5d5eba99f1cba043cb3898"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the interface to the HDF5 library and open the output file. <br /></td></tr>
<tr class="separator:ga0f962c09cd5d5eba99f1cba043cb3898"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafed4d951aec99f2ebeba68c465eb9861"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__grp__output.html#gafed4d951aec99f2ebeba68c465eb9861">sphdf5::mirror_input_to_outfile</a></td></tr>
<tr class="memdesc:gafed4d951aec99f2ebeba68c465eb9861"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mirror input variables into output file.  <a href="group__grp__output.html#gafed4d951aec99f2ebeba68c465eb9861">More...</a><br /></td></tr>
<tr class="separator:gafed4d951aec99f2ebeba68c465eb9861"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab348ec00943ff875a1ebb965fb98841e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__grp__output.html#gab348ec00943ff875a1ebb965fb98841e">sphdf5::init_convergence_output</a></td></tr>
<tr class="memdesc:gab348ec00943ff875a1ebb965fb98841e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare convergence evolution output.  <a href="group__grp__output.html#gab348ec00943ff875a1ebb965fb98841e">More...</a><br /></td></tr>
<tr class="separator:gab348ec00943ff875a1ebb965fb98841e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gade76c03b9b11be2a12d3ddd32e77a6ae"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__grp__output.html#gade76c03b9b11be2a12d3ddd32e77a6ae">sphdf5::write_convergence_output</a> (nDcalls, ForceErr)</td></tr>
<tr class="memdesc:gade76c03b9b11be2a12d3ddd32e77a6ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write convergence output (evolution of interface geometry, force, etc).  <a href="group__grp__output.html#gade76c03b9b11be2a12d3ddd32e77a6ae">More...</a><br /></td></tr>
<tr class="separator:gade76c03b9b11be2a12d3ddd32e77a6ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga17e65b951634f7098213fd071d905482"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__grp__output.html#ga17e65b951634f7098213fd071d905482">sphdf5::write_grid</a></td></tr>
<tr class="memdesc:ga17e65b951634f7098213fd071d905482"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the magnetic field on a grid.  <a href="group__grp__output.html#ga17e65b951634f7098213fd071d905482">More...</a><br /></td></tr>
<tr class="separator:ga17e65b951634f7098213fd071d905482"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga47186186c9418cd913ee9c98b5668642"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__grp__output.html#ga47186186c9418cd913ee9c98b5668642">sphdf5::init_flt_output</a> (numTrajTotal)</td></tr>
<tr class="memdesc:ga47186186c9418cd913ee9c98b5668642"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize field line tracing output group and create array datasets.  <a href="group__grp__output.html#ga47186186c9418cd913ee9c98b5668642">More...</a><br /></td></tr>
<tr class="separator:ga47186186c9418cd913ee9c98b5668642"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga14195bd206b7f6a7f05d4d6fc4b50f42"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__grp__output.html#ga14195bd206b7f6a7f05d4d6fc4b50f42">sphdf5::write_poincare</a> (offset, data, success)</td></tr>
<tr class="memdesc:ga14195bd206b7f6a7f05d4d6fc4b50f42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a hyperslab of Poincare data corresponding to the output of one parallel worker.  <a href="group__grp__output.html#ga14195bd206b7f6a7f05d4d6fc4b50f42">More...</a><br /></td></tr>
<tr class="separator:ga14195bd206b7f6a7f05d4d6fc4b50f42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8f01c5e4a21c5af2c39620f24e598095"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__grp__output.html#ga8f01c5e4a21c5af2c39620f24e598095">sphdf5::write_transform</a> (offset, length, lvol, diotadxup, fiota)</td></tr>
<tr class="memdesc:ga8f01c5e4a21c5af2c39620f24e598095"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the rotational transform output from field line following.  <a href="group__grp__output.html#ga8f01c5e4a21c5af2c39620f24e598095">More...</a><br /></td></tr>
<tr class="separator:ga8f01c5e4a21c5af2c39620f24e598095"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacd97a933d4239028dc8114b110655074"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__grp__output.html#gacd97a933d4239028dc8114b110655074">sphdf5::finalize_flt_output</a></td></tr>
<tr class="memdesc:gacd97a933d4239028dc8114b110655074"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalize Poincare output.  <a href="group__grp__output.html#gacd97a933d4239028dc8114b110655074">More...</a><br /></td></tr>
<tr class="separator:gacd97a933d4239028dc8114b110655074"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2f9e9c50084175e5174b1e1070e24d73"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__grp__output.html#ga2f9e9c50084175e5174b1e1070e24d73">sphdf5::write_vector_potential</a> (sumLrad, allAte, allAze, allAto, allAzo)</td></tr>
<tr class="memdesc:ga2f9e9c50084175e5174b1e1070e24d73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the magnetic vector potential Fourier harmonics to the output file group <code>/vector_potential</code> .  <a href="group__grp__output.html#ga2f9e9c50084175e5174b1e1070e24d73">More...</a><br /></td></tr>
<tr class="separator:ga2f9e9c50084175e5174b1e1070e24d73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga593e99355c8ceabe56a566e9d468dbd9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__grp__output.html#ga593e99355c8ceabe56a566e9d468dbd9">sphdf5::hdfint</a></td></tr>
<tr class="memdesc:ga593e99355c8ceabe56a566e9d468dbd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the final state of the equilibrium to the output file.  <a href="group__grp__output.html#ga593e99355c8ceabe56a566e9d468dbd9">More...</a><br /></td></tr>
<tr class="separator:ga593e99355c8ceabe56a566e9d468dbd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadb720ea6408b8f7681bfb7f86a4b86f2"><td class="memItemLeft" align="right" valign="top"><a id="gadb720ea6408b8f7681bfb7f86a4b86f2" name="gadb720ea6408b8f7681bfb7f86a4b86f2"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><b>sphdf5::finish_outfile</b></td></tr>
<tr class="memdesc:gadb720ea6408b8f7681bfb7f86a4b86f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close all open HDF5 objects (we know of) and list any remaining still-open objects. <br /></td></tr>
<tr class="separator:gadb720ea6408b8f7681bfb7f86a4b86f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ga7401b50ec10c6598ee4a8112717a63ec" name="ga7401b50ec10c6598ee4a8112717a63ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7401b50ec10c6598ee4a8112717a63ec">&#9670;&nbsp;</a></span>hesian()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hesian </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NGdof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(0:ngdof)&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>Mvol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>LGdof</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes eigenvalues and eigenvectors of derivative matrix, \(\nabla_{\bf xi}{\bf F}\) and saves them to <code></code>.ext.GF.ev and <code></code>.ext.GF.ma. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">NGdof</td><td>number of global degrees of freedom </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">position</td><td>internal geometrical degrees of freedom </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Mvol</td><td>total number of volumes in computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mn</td><td>number of Fourier harmonics </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LGdof</td><td>what is this? </td></tr>
  </table>
  </dd>
</dl>
<p ><b>construction of Hessian matrix</b> </p><ul>
<li>
The routine <a class="el" href="group__grp__global__force.html#ga38c9d3c50bd043707fefa5137c9dbf44" title="Calculates , where  and , and .">dforce()</a> is used to compute the derivatives, with respect to interface geometry, of the force imbalance harmonics, \([[p+B^2/2]]_{j}\), which may be considered to be the "physical" constraints, and if <code>Igeometry==3</code> then also the derivatives of the "artificial" spectral constraints, \(I_j \equiv (R_\theta X + Z_\theta Y)_j\).  </li>
<li>
The input variable <code>Lconstraint</code> determines how the enclosed fluxes, \(\Delta \psi_t\) and \(\Delta \psi_p\), and the helicity multiplier, \(\mu\), vary as the geometry is varied; see <a class="el" href="global_8f90.html" title="Defines input namelists and global variables, and opens some output files.">global.f90</a> and <a class="el" href="group__grp__solver.html#ga6626839aff500f060beb5bce2b90c447" title="Solves Beltrami/vacuum (linear) system, given matrices.unpacking fluxes, helicity multiplier">mp00ac()</a> for more details.  </li>
</ul>
<p ><b>construction of eigenvalues and eigenvectors</b> </p><ul>
<li>
If <code>LHevalues==T</code> then the eigenvalues of the Hessian are computed using the NAG routine <code>F02EBF</code>.  </li>
<li>
If <code>LHevectors==T</code> then the eigenvalues <em>and</em> the eigenvectors of the Hessian are computed.  </li>
<li>
Note that if <code>Igeometry==3</code>, then the derivative-matrix also contains information regarding how the "artificial" spectral constraints vary with geometry; so, the eigenvalues and eigenvectors are not purely "physical".  </li>
<li>
<p class="startli">The eigenvalues and eigenvectors (if required) are written to the file <code></code>.ext.GF.ev as follows:</p>
<div class="fragment"><div class="line"><span class="keyword">open</span>(hunit,file=trim(get_hidden(ext))//<span class="stringliteral">&quot;.GF.ev&quot;</span>,status=<span class="stringliteral">&quot;unknown&quot;</span>,form=<span class="stringliteral">&quot;unformatted&quot;</span>)</div>
<div class="line"><span class="keyword">write</span>(hunit)ngdof,ldvr,ldvi        <span class="comment">! integers; if only the eigenvalues were computed then Ldvr=Ldvi=1;</span></div>
<div class="line"><span class="keyword">write</span>(hunit)evalr(1:ngdof)         <span class="comment">! reals   ; real      part of eigenvalues;</span></div>
<div class="line"><span class="keyword">write</span>(hunit)evali(1:ngdof)         <span class="comment">! reals   ; imaginary part of eigenvalues;</span></div>
<div class="line"><span class="keyword">write</span>(hunit)evecr(1:ngdof,1:ngdof) <span class="comment">! reals   ; real      part of eigenvalues; only if Ldvr=NGdof;</span></div>
<div class="line"><span class="keyword">write</span>(hunit)eveci(1:ngdof,1:ngdof) <span class="comment">! reals   ; imaginary part of eigenvalues; only if Ldvi=NGdof;</span></div>
<div class="line"><span class="keyword">close</span>(hunit)</div>
</div><!-- fragment -->  </li>
<li>
The eigenvectors are saved in columns of <code>evecr</code>, <code>eveci</code>, as described by the NAG documentation for <code>F02EBF</code>.  </li>
</ul>

<p class="reference">References <a class="el" href="namespaceallglobal.html#afae71b580d9f9c71a6796207a5411959">allglobal::cpus</a>, <a class="el" href="group__grp__par__deriv__mat.html#gac48e5a242739199fc49133a066b63731">allglobal::dbbdmp</a>, <a class="el" href="group__grp__par__deriv__mat.html#gaa8cd95dfadae2d93584c39b12189991a">allglobal::dbbdrz</a>, <a class="el" href="group__grp__par__deriv__mat.html#gaa9d6eedf4516477eb765c1985ea57c3c">allglobal::denergydrr</a>, <a class="el" href="group__grp__par__deriv__mat.html#gae81fe65c376d2dc9e597d7b9de969f30">allglobal::denergydrz</a>, <a class="el" href="group__grp__par__deriv__mat.html#gadeaab07f09e44924b64e4e5808f461e5">allglobal::denergydzr</a>, <a class="el" href="group__grp__par__deriv__mat.html#gac7b00712a173d54e54e691ecd9d30c56">allglobal::denergydzz</a>, <a class="el" href="group__grp__deriv__mul__polflux.html#ga62fde4fa7074396fee8b02aae1ce5230">allglobal::dessian</a>, <a class="el" href="group__grp__deriv__mul__polflux.html#ga1fe8dd67e50296b9442b3b74373c9f6d">allglobal::dessian2d</a>, <a class="el" href="group__grp__par__deriv__mat.html#ga2e133adf1f9c191fb41db6bf9b3d57b4">allglobal::dffdrz</a>, <a class="el" href="group__grp__global__force.html#ga38c9d3c50bd043707fefa5137c9dbf44">dforce()</a>, <a class="el" href="group__grp__deriv__mul__polflux.html#gadbfeeb10efad1a2a84fe800073a0ba18">allglobal::dmupfdx</a>, <a class="el" href="group__grp__global__diagnostics.html#ga2ba67a016005a50d6b82280622de6261">inputlist::dpp</a>, <a class="el" href="group__grp__global__diagnostics.html#gaa0f15308763e13b3a75afa1b64d63af0">inputlist::dqq</a>, <a class="el" href="group__grp__iface__geom.html#gafa2f03a88e4ba78c9bda1e3bacf9c9e2">allglobal::drbc</a>, <a class="el" href="group__grp__iface__geom.html#gad0e2b0f2bc8714bcaa028f2515417323">allglobal::drbs</a>, <a class="el" href="group__grp__iface__geom.html#gadf12baed692019acfd4f87edfb30e135">allglobal::dzbc</a>, <a class="el" href="group__grp__iface__geom.html#gad49624ff761950b3d7684815994db03a">allglobal::dzbs</a>, <a class="el" href="namespaceallglobal.html#a07f3f4df2aaac1b26a68b04a2c4464d6">allglobal::energy</a>, <a class="el" href="namespaceconstants.html#a28ec2b391ac319cee0f31bb295b89cc2">constants::half</a>, <a class="el" href="group__grp__par__deriv__mat.html#ga68a46902a95eb52690d14301793361f7">allglobal::hdffdrz</a>, <a class="el" href="group__grp__global__physicslist.html#ga46c6c39acda26e483cb0902fabbd8156">inputlist::helicity</a>, <a class="el" href="group__grp__output.html#ga7401b50ec10c6598ee4a8112717a63ec">hesian()</a>, <a class="el" href="group__grp__deriv__mul__polflux.html#gaa553e278b8449f3bb0b7dc4d4c17e115">allglobal::hessian</a>, <a class="el" href="group__grp__deriv__mul__polflux.html#ga7f5b07d2e78323799aa09693a86dc280">allglobal::hessian2d</a>, <a class="el" href="namespacefileunits.html#a9ba5fd8cc8bbfea2806d5439078a71b9">fileunits::hunit</a>, <a class="el" href="group__grp__global__physicslist.html#gaa6dcbfd2f5cb5f23f4bc567fb13ae0e2">inputlist::igeometry</a>, <a class="el" href="group__grp__fourier__repr.html#gaeac30068003c58add7893688ea2e48aa">allglobal::im</a>, <a class="el" href="group__grp__fourier__repr.html#gae946717d1654463c7cb4b1d7fd712f7d">allglobal::in</a>, <a class="el" href="group__grp__iface__geom.html#ga9f6e014546551429956a2a47c134d07b">allglobal::irbc</a>, <a class="el" href="group__grp__iface__geom.html#ga05ba18442623cf5f34f7a2193a03e0b1">allglobal::irbs</a>, <a class="el" href="group__grp__iface__geom.html#ga6c7ad3b18081227f992e4c3e73a2e216">allglobal::izbc</a>, <a class="el" href="group__grp__iface__geom.html#gadcc12f5e32287fd4b60dc01afc6e64d2">allglobal::izbs</a>, <a class="el" href="group__grp__volints.html#gab20ed074ab128f16af16278e634fdc89">allglobal::lbbintegral</a>, <a class="el" href="group__grp__global__diagnostics.html#ga9bd118017d70e35d658a10463ab4c1dc">inputlist::lcheck</a>, <a class="el" href="group__grp__global__global.html#ga28b1d8d67e6902726c87fe0785c1634e">inputlist::lfindzero</a>, <a class="el" href="group__grp__global__physicslist.html#ga1b86a8de5a6a81fe5524d6e23068813e">inputlist::lfreebound</a>, <a class="el" href="group__grp__deriv__mul__polflux.html#ga3ad879f192d9b11697fd8d38954f031d">allglobal::lhessian2dallocated</a>, <a class="el" href="group__grp__deriv__mul__polflux.html#ga10595494020d6bc72cece598f835d13c">allglobal::lhessian3dallocated</a>, <a class="el" href="group__grp__deriv__mul__polflux.html#gaf1a9487e823ebb9ca913e69a122ed9a8">allglobal::lhessianallocated</a>, <a class="el" href="group__grp__global__diagnostics.html#ga1ffbe726af9975df667836574dc421e7">inputlist::lhevalues</a>, <a class="el" href="group__grp__global__diagnostics.html#ga3b561efdb5e6ef16d8b19c1e8cc3b778">inputlist::lhevectors</a>, <a class="el" href="group__grp__global__diagnostics.html#gae577c62c326c41415e156c47d4c25254">inputlist::lhmatrix</a>, <a class="el" href="group__grp__vecpot.html#ga141035c38dd079ea76b0ddd5df964de7">allglobal::localconstraint</a>, <a class="el" href="group__grp__global__diagnostics.html#gaf5f29c4832896ed0a163c214132d2aa2">inputlist::lperturbed</a>, <a class="el" href="namespaceallglobal.html#a2382df770fc57cc53ed68c6e1ac23819">allglobal::mpi_comm_spec</a>, <a class="el" href="group__grp__global__physicslist.html#ga434a83d47ab8804a8c88e9e09f194bf2">inputlist::mu</a>, <a class="el" href="namespacefileunits.html#a838dcc223dd1332189ef2b0f490c93ec">fileunits::munit</a>, <a class="el" href="namespaceallglobal.html#aca1163f9aab48251a99d00e63618cc39">allglobal::myid</a>, <a class="el" href="namespaceallglobal.html#aa45097c36006ab1ffc0cb06a927ed02a">allglobal::ncpu</a>, <a class="el" href="namespaceallglobal.html#a6993aa662f74b327357896c7d9c81f4b">allglobal::notstellsym</a>, <a class="el" href="group__grp__global__physicslist.html#gafdbe1fac5fd98bb41ae5cc363ab9aedd">inputlist::nvol</a>, <a class="el" href="namespaceconstants.html#ad5224c0b5e13bf12b18dafbb62ba4e8d">constants::one</a>, <a class="el" href="namespacefileunits.html#a7463305b9ff5b4b659d87f6fa59f74a7">fileunits::ounit</a>, <a class="el" href="group__grp__packing.html#ga094e630c02686dd178749eb1efbf13fb">packxi()</a>, <a class="el" href="group__grp__global__physicslist.html#ga1d7cc174857156ba5e880eddbe25b65b">inputlist::pflux</a>, <a class="el" href="group__grp__initialization.html#ga28628de0fdb3b3497668007d8d0643bd">preset()</a>, <a class="el" href="group__grp__fourier__repr.html#ga88327909830819e416eccfce2bdc3ea6">allglobal::psifactor</a>, <a class="el" href="namespacenumerical.html#aba4e665eb2dabaf1e12c82a7270ac0c0">numerical::small</a>, <a class="el" href="namespacenumerical.html#a50ec27b16837c03b9381df06224a758f">numerical::sqrtmachprec</a>, <a class="el" href="namespaceconstants.html#a829cc09d9813f2ca64d278bacb4009d0">constants::ten</a>, <a class="el" href="namespaceconstants.html#a77f9c93617de9c40ab41a50a157fb90d">constants::two</a>, <a class="el" href="namespacenumerical.html#a37691ec078f21840c475c4c7b83d7d31">numerical::vsmall</a>, <a class="el" href="group__grp__global__screenlist.html#gaef361ceee97e08e5f134227903265494">inputlist::wmacros</a>, <a class="el" href="namespaceallglobal.html#a1f4ddb89b3246fef8d73c88b730eda3a">allglobal::yesstellsym</a>, and <a class="el" href="namespaceconstants.html#ab2b0340319f61089513f5dd1d3971a47">constants::zero</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__grp__output.html#ga7401b50ec10c6598ee4a8112717a63ec">hesian()</a>, and <a class="el" href="xspech_8f90.html#a48f45478dc2c9f70ea8aa1c60ad06503">spec()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_ga7401b50ec10c6598ee4a8112717a63ec_cgraph.svg" width="2166" height="2996"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_ga7401b50ec10c6598ee4a8112717a63ec_icgraph.svg" width="970" height="623"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ga382822b303cbf8c56d6f54dcb379caf2" name="ga382822b303cbf8c56d6f54dcb379caf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga382822b303cbf8c56d6f54dcb379caf2">&#9670;&nbsp;</a></span>writereadgf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine writereadgf </td>
          <td>(</td>
          <td class="paramtype">character, intent(in)&#160;</td>
          <td class="paramname"><em>readorwrite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NGdof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>ireadhessian</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read or write force-derivative matrix <code></code>.ext.sp.DF </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">readorwrite</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NGdof</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ireadhessian</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="namespaceallglobal.html#afae71b580d9f9c71a6796207a5411959">allglobal::cpus</a>, <a class="el" href="namespacefileunits.html#aa9432484bf73d21e8797f595bf9e3cd6">fileunits::dunit</a>, <a class="el" href="group__grp__deriv__mul__polflux.html#gaa553e278b8449f3bb0b7dc4d4c17e115">allglobal::hessian</a>, <a class="el" href="group__grp__global__physicslist.html#gaa6dcbfd2f5cb5f23f4bc567fb13ae0e2">inputlist::igeometry</a>, <a class="el" href="group__grp__fourier__repr.html#gaeac30068003c58add7893688ea2e48aa">allglobal::im</a>, <a class="el" href="group__grp__fourier__repr.html#gae946717d1654463c7cb4b1d7fd712f7d">allglobal::in</a>, <a class="el" href="group__grp__global__physicslist.html#ga6a4521a3050f938b6c4cb0681ce0b8b5">inputlist::istellsym</a>, <a class="el" href="group__grp__global__physicslist.html#ga1b86a8de5a6a81fe5524d6e23068813e">inputlist::lfreebound</a>, <a class="el" href="group__grp__deriv__mul__polflux.html#gaf1a9487e823ebb9ca913e69a122ed9a8">allglobal::lhessianallocated</a>, <a class="el" href="group__grp__build__matrices.html#ga1c52bb6dbffdb432550aae12b096080f">matrix()</a>, <a class="el" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400">allglobal::mn</a>, <a class="el" href="namespaceallglobal.html#a2382df770fc57cc53ed68c6e1ac23819">allglobal::mpi_comm_spec</a>, <a class="el" href="group__grp__global__physicslist.html#ga37922639dc82622c797f406474d1087a">inputlist::mpol</a>, <a class="el" href="namespaceallglobal.html#aca1163f9aab48251a99d00e63618cc39">allglobal::myid</a>, <a class="el" href="group__grp__force__driver.html#gaec14f81fbdbedafbc4189489ec8ae178">newton()</a>, <a class="el" href="group__grp__global__physicslist.html#ga44cde2d69503cc15bb6f31349d2900a6">inputlist::ntor</a>, <a class="el" href="group__grp__global__physicslist.html#gafdbe1fac5fd98bb41ae5cc363ab9aedd">inputlist::nvol</a>, <a class="el" href="namespacefileunits.html#a7463305b9ff5b4b659d87f6fa59f74a7">fileunits::ounit</a>, and <a class="el" href="namespaceconstants.html#ab2b0340319f61089513f5dd1d3971a47">constants::zero</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__grp__force__driver.html#ga8ccd6c7d901872702521d0a0edf95412">fcn2()</a>, and <a class="el" href="group__grp__force__driver.html#gaec14f81fbdbedafbc4189489ec8ae178">newton()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_ga382822b303cbf8c56d6f54dcb379caf2_cgraph.svg" width="2454" height="2760"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_ga382822b303cbf8c56d6f54dcb379caf2_icgraph.svg" width="1104" height="472"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ga08d6a254dbc3d9d40ff1cf0bdfdf2148" name="ga08d6a254dbc3d9d40ff1cf0bdfdf2148"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga08d6a254dbc3d9d40ff1cf0bdfdf2148">&#9670;&nbsp;</a></span>ra00aa()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ra00aa </td>
          <td>(</td>
          <td class="paramtype">character, intent(in)&#160;</td>
          <td class="paramname"><em>writeorread</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes vector potential to <code></code>.ext.sp.A . </p>
<p ><b>representation of vector potential</b></p>
<ul>
<li>
The components of the vector potential, \({\bf A}=A_\theta \nabla + A_\zeta \nabla \zeta\), are <p class="formulaDsp">
\begin{eqnarray} A_\theta(s,\theta,\zeta) &amp;=&amp; \sum_{i,l} {\color{red} A_{\theta,e,i,l}} \; {\overline T}_{l,i}(s) \cos\alpha_i + \sum_{i,l} {\color{Orange} A_{\theta,o,i,l}} \; {\overline T}_{l,i}(s) \sin\alpha_i, \label{eq:At_ra00aa} \\ A_\zeta( s,\theta,\zeta) &amp;=&amp; \sum_{i,l} {\color{blue} A_{\zeta, e,i,l}} \; {\overline T}_{l,i}(s) \cos\alpha_i + \sum_{i,l} {\color{Cerulean}A_{\zeta ,o,i,l}} \; {\overline T}_{l,i}(s) \sin\alpha_i, \label{eq:Az_ra00aa} \end{eqnarray}
</p>
 where \({\overline T}_{l,i}(s) \equiv \bar s^{m_i/2} \, T_l(s)\), \(T_l(s)\) is the Chebyshev polynomial, and \(\alpha_j \equiv m_j\theta-n_j\zeta\). The regularity factor, \(\bar s^{m_i/2}\), where \(\bar s \equiv (1+s)/2\), is only included if there is a coordinate singularity in the domain (i.e. only in the innermost volume, and only in cylindrical and toroidal geometry.)  </li>
</ul>
<p ><b>file format</b></p>
<ul>
<li>
The format of the files containing the vector potential is as follows: <div class="fragment"><div class="line"><span class="keyword">open</span>(aunit, file=trim(get_hidden(ext))//<span class="stringliteral">&quot;.sp.A&quot;</span>, status=<span class="stringliteral">&quot;replace&quot;</span>, form=<span class="stringliteral">&quot;unformatted&quot;</span> )</div>
<div class="line"><span class="keyword">write</span>(aunit) mvol, mpol, ntor, mn, nfp <span class="comment">! integers;</span></div>
<div class="line"><span class="keyword">write</span>(aunit) im(1:mn) <span class="comment">! integers; poloidal modes;</span></div>
<div class="line"><span class="keyword">write</span>(aunit) in(1:mn) <span class="comment">! integers; toroidal modes;</span></div>
<div class="line"><span class="keywordflow">do</span> vvol = 1, mvol <span class="comment">! integers; loop over volumes;</span></div>
<div class="line"><span class="keyword">write</span>(aunit) lrad(vvol) <span class="comment">! integers; the radial resolution in each volume may be different;</span></div>
<div class="line"><span class="keywordflow">do</span> ii = 1, mn</div>
<div class="line"><span class="keyword">write</span>(aunit) ate(vvol,ii)%s(0:lrad(vvol)) <span class="comment">! reals;</span></div>
<div class="line"><span class="keyword">write</span>(aunit) aze(vvol,ii)%s(0:lrad(vvol)) <span class="comment">! reals;</span></div>
<div class="line"><span class="keyword">write</span>(aunit) ato(vvol,ii)%s(0:lrad(vvol)) <span class="comment">! reals;</span></div>
<div class="line"><span class="keyword">write</span>(aunit) azo(vvol,ii)%s(0:lrad(vvol)) <span class="comment">! reals;</span></div>
<div class="line"><span class="keywordflow">enddo</span> <span class="comment">! end of do ii;</span></div>
<div class="line"><span class="keywordflow">enddo</span> <span class="comment">! end of do vvol;</span></div>
<div class="line"><span class="keyword">close</span>(aunit)</div>
</div><!-- fragment -->  </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">writeorread</td><td>'W' to write the vector potential; 'R' to read it </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="group__grp__vecpot.html#ga430fa6f9a3ebb7a56185b72b8ea1ff49">allglobal::ate</a>, <a class="el" href="group__grp__vecpot.html#gaefec3203c02505c73b48dbb1c7ba96c1">allglobal::ato</a>, <a class="el" href="namespacefileunits.html#ace695af9e73beb4e7f7abe2efe069ed1">fileunits::aunit</a>, <a class="el" href="group__grp__vecpot.html#gad85df9e26321392291e0a43478da0f3c">allglobal::aze</a>, <a class="el" href="group__grp__vecpot.html#gad52dcff52cc620916d5e765051a0228a">allglobal::azo</a>, <a class="el" href="namespaceallglobal.html#afae71b580d9f9c71a6796207a5411959">allglobal::cpus</a>, <a class="el" href="group__grp__fourier__repr.html#gaeac30068003c58add7893688ea2e48aa">allglobal::im</a>, <a class="el" href="group__grp__fourier__repr.html#gae946717d1654463c7cb4b1d7fd712f7d">allglobal::in</a>, <a class="el" href="group__grp__global__physicslist.html#ga1509b6ce73e909b86beaf65c26527932">inputlist::lrad</a>, <a class="el" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400">allglobal::mn</a>, <a class="el" href="namespaceallglobal.html#a2382df770fc57cc53ed68c6e1ac23819">allglobal::mpi_comm_spec</a>, <a class="el" href="group__grp__global__physicslist.html#ga37922639dc82622c797f406474d1087a">inputlist::mpol</a>, <a class="el" href="namespaceallglobal.html#aa2a4850f9468d817a673c1ef7f718849">allglobal::mvol</a>, <a class="el" href="namespaceallglobal.html#aca1163f9aab48251a99d00e63618cc39">allglobal::myid</a>, <a class="el" href="namespaceallglobal.html#aa45097c36006ab1ffc0cb06a927ed02a">allglobal::ncpu</a>, <a class="el" href="group__grp__global__physicslist.html#gae071c5738f7f7a6ada9d6b66676e37c7">inputlist::nfp</a>, <a class="el" href="group__grp__global__physicslist.html#ga44cde2d69503cc15bb6f31349d2900a6">inputlist::ntor</a>, <a class="el" href="namespacefileunits.html#a7463305b9ff5b4b659d87f6fa59f74a7">fileunits::ounit</a>, <a class="el" href="group__grp__output.html#ga08d6a254dbc3d9d40ff1cf0bdfdf2148">ra00aa()</a>, <a class="el" href="group__grp__global__screenlist.html#gaef361ceee97e08e5f134227903265494">inputlist::wmacros</a>, <a class="el" href="group__grp__output.html#ga2f9e9c50084175e5174b1e1070e24d73">sphdf5::write_vector_potential()</a>, and <a class="el" href="namespaceconstants.html#ab2b0340319f61089513f5dd1d3971a47">constants::zero</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__grp__initialization.html#ga28628de0fdb3b3497668007d8d0643bd">preset()</a>, <a class="el" href="group__grp__output.html#ga08d6a254dbc3d9d40ff1cf0bdfdf2148">ra00aa()</a>, and <a class="el" href="xspech_8f90.html#a48f45478dc2c9f70ea8aa1c60ad06503">spec()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_ga08d6a254dbc3d9d40ff1cf0bdfdf2148_cgraph.svg" width="259" height="70"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_ga08d6a254dbc3d9d40ff1cf0bdfdf2148_icgraph.svg" width="1186" height="604"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="gafed4d951aec99f2ebeba68c465eb9861" name="gafed4d951aec99f2ebeba68c465eb9861"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafed4d951aec99f2ebeba68c465eb9861">&#9670;&nbsp;</a></span>mirror_input_to_outfile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sphdf5::mirror_input_to_outfile</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mirror input variables into output file. </p>
<p >The goal of this routine is to have an exact copy of the input file contents that were used to parameterize a given SPEC run. This also serves to check after the run if SPEC correctly understood the text-based input file. </p>

<p class="reference">References <a class="el" href="group__grp__global__diagnostics.html#ga2c61afaded61fcaacffd320521a5a62e">inputlist::absacc</a>, <a class="el" href="group__grp__global__diagnostics.html#ga24d3520957ca6e2de63187836baa78d6">inputlist::absreq</a>, <a class="el" href="group__grp__global__physicslist.html#ga1b110ff3c17b7dac3af444ab9e42e3d2">inputlist::adiabatic</a>, <a class="el" href="group__grp__global__physicslist.html#ga3983410e9a76500984fa4a75877315b2">inputlist::bnc</a>, <a class="el" href="group__grp__global__physicslist.html#ga82eafba423cb98f235e79a29a582abd8">inputlist::bns</a>, <a class="el" href="group__grp__global__global.html#ga2e4b34a235e965df691cea4db96e8b40">inputlist::bnsblend</a>, <a class="el" href="group__grp__global__global.html#ga59c4a8840fb74024c03ec05e7394082e">inputlist::bnstol</a>, <a class="el" href="group__grp__global__global.html#ga32e1a65ba41f2c4fc298bc9db4cc7e15">inputlist::c05factor</a>, <a class="el" href="group__grp__global__global.html#ga6afae1f88ed1efd5cfc6ede989bc4599">inputlist::c05xmax</a>, <a class="el" href="group__grp__global__global.html#gae2292284df0cfc97af49e6bee0067cf8">inputlist::c05xtol</a>, <a class="el" href="group__grp__global__physicslist.html#ga0bb50836068b8cd6ba6fad6dc868a434">inputlist::curpol</a>, <a class="el" href="group__grp__global__physicslist.html#gab928d9c972181bd85b4a562640e322b7">inputlist::curtor</a>, <a class="el" href="group__grp__global__diagnostics.html#ga2ba67a016005a50d6b82280622de6261">inputlist::dpp</a>, <a class="el" href="group__grp__global__diagnostics.html#gaa0f15308763e13b3a75afa1b64d63af0">inputlist::dqq</a>, <a class="el" href="group__grp__global__local.html#ga024734f6d8a768292605eb82319e1adb">inputlist::epsgmres</a>, <a class="el" href="group__grp__global__global.html#ga4fecdfe090241bd5347c604de5cb43d6">inputlist::epsilon</a>, <a class="el" href="group__grp__global__local.html#ga047fe610bcf9bfd6d0ad6bf0bdb7cb8a">inputlist::epsilu</a>, <a class="el" href="group__grp__global__diagnostics.html#gac51054b3df053c1ff903fd99a4d82be4">inputlist::epsr</a>, <a class="el" href="group__grp__global__global.html#gab8133b0a6c3db5ce271075e08bfa9eca">inputlist::escale</a>, <a class="el" href="namespacesphdf5.html#a5ebb9276a31deb0bcbe482da78f4b5b2">sphdf5::file_id</a>, <a class="el" href="group__grp__global__global.html#gaf71cafda56b8d5f40bdbee2fadefb8e2">inputlist::forcetol</a>, <a class="el" href="group__grp__global__diagnostics.html#ga7234abca2702c9228401b7d96fe8d655">inputlist::fudge</a>, <a class="el" href="group__grp__global__physicslist.html#ga778f38f46639ce987228193dbc29626d">inputlist::gamma</a>, <a class="el" href="group__grp__global__global.html#ga8ee4cd7ee59ab34c0b7b1c87ca98cd7e">inputlist::gbnbld</a>, <a class="el" href="group__grp__global__global.html#ga70cca5731c42473a24ab5b3db73f10b4">inputlist::gbntol</a>, <a class="el" href="group__grp__global__physicslist.html#ga46c6c39acda26e483cb0902fabbd8156">inputlist::helicity</a>, <a class="el" href="group__grp__global__physicslist.html#gaa6dcbfd2f5cb5f23f4bc567fb13ae0e2">inputlist::igeometry</a>, <a class="el" href="group__grp__global__numerics.html#ga53d4f46768973b317f7c8fe58425449a">inputlist::imethod</a>, <a class="el" href="group__grp__global__numerics.html#ga147e548e274331eb5b63de3e752ae199">inputlist::impol</a>, <a class="el" href="group__grp__fourier__repr.html#gae946717d1654463c7cb4b1d7fd712f7d">allglobal::in</a>, <a class="el" href="group__grp__global__numerics.html#ga2e7d643c07d747a27401604d00288ca7">inputlist::intor</a>, <a class="el" href="group__grp__global__numerics.html#ga9ca8b3935c253c847cf9623ab58bb8a7">inputlist::iorder</a>, <a class="el" href="group__grp__global__physicslist.html#gac50acc1dcbce4d6ea4f6df093b115637">inputlist::iota</a>, <a class="el" href="group__grp__global__numerics.html#gab9b86a7286188d81b99ce5b29f3e4178">inputlist::iotatol</a>, <a class="el" href="group__grp__global__numerics.html#gac0e3fcd01b8a541e2a2aa9128cbb0346">inputlist::iprecon</a>, <a class="el" href="group__grp__global__physicslist.html#ga6a4521a3050f938b6c4cb0681ce0b8b5">inputlist::istellsym</a>, <a class="el" href="group__grp__global__physicslist.html#ga6101a320f6577fdbc320f6a33f82ee90">inputlist::isurf</a>, <a class="el" href="group__grp__global__physicslist.html#gae5aba6f12ca82ce11c2a577102c64820">inputlist::ivolume</a>, <a class="el" href="group__grp__global__physicslist.html#ga2a9aa5fda4787ae756c3216be559e743">inputlist::ladiabatic</a>, <a class="el" href="group__grp__global__local.html#ga7313f6a9dcc40242adf1ac39d3b107a9">inputlist::lbeltrami</a>, <a class="el" href="group__grp__global__diagnostics.html#ga9bd118017d70e35d658a10463ab4c1dc">inputlist::lcheck</a>, <a class="el" href="group__grp__global__physicslist.html#gafa9685795dd6029e20fc50e564b78018">inputlist::lconstraint</a>, <a class="el" href="group__grp__global__diagnostics.html#ga8a82bce4c861dae58215e903b5630bca">inputlist::lerrortype</a>, <a class="el" href="group__grp__global__numerics.html#ga4cb7cb36150c0b605be2c529bde11dc5">inputlist::lextrap</a>, <a class="el" href="group__grp__global__global.html#ga28b1d8d67e6902726c87fe0785c1634e">inputlist::lfindzero</a>, <a class="el" href="group__grp__global__physicslist.html#ga1b86a8de5a6a81fe5524d6e23068813e">inputlist::lfreebound</a>, <a class="el" href="group__grp__global__local.html#ga79a00689c2cf867d2084abe7a382c8b2">inputlist::lgmresprec</a>, <a class="el" href="group__grp__global__diagnostics.html#ga1ffbe726af9975df667836574dc421e7">inputlist::lhevalues</a>, <a class="el" href="group__grp__global__diagnostics.html#ga3b561efdb5e6ef16d8b19c1e8cc3b778">inputlist::lhevectors</a>, <a class="el" href="group__grp__global__diagnostics.html#gae577c62c326c41415e156c47d4c25254">inputlist::lhmatrix</a>, <a class="el" href="group__grp__global__local.html#ga597fb03d346df805ffc028f3bb21145b">inputlist::linitgues</a>, <a class="el" href="group__grp__global__numerics.html#ga0322eaea79e44a1e8ee6c6793f508099">inputlist::linitialize</a>, <a class="el" href="group__grp__global__local.html#gaac24dc13bce0966f21f862e555337e42">inputlist::lmatsolver</a>, <a class="el" href="group__grp__global__physicslist.html#ga91fd05f3240d75f817e0aa228e8049d0">inputlist::lp</a>, <a class="el" href="group__grp__global__diagnostics.html#gaf5f29c4832896ed0a163c214132d2aa2">inputlist::lperturbed</a>, <a class="el" href="group__grp__global__local.html#gac84a79e149da6433b2a320c5de6ffe8a">inputlist::lposdef</a>, <a class="el" href="group__grp__global__physicslist.html#ga23516af92680490fe6bfda77113ba81d">inputlist::lq</a>, <a class="el" href="group__grp__global__physicslist.html#ga1509b6ce73e909b86beaf65c26527932">inputlist::lrad</a>, <a class="el" href="group__grp__global__global.html#ga72e2fc0a6ee65f1d17a0fcf3329c08f8">inputlist::lreadgf</a>, <a class="el" href="group__grp__global__physicslist.html#ga44b8bd3a3a924f4a6bf87032c31d1b87">inputlist::lreflect</a>, <a class="el" href="group__grp__global__numerics.html#gaca1c98553526428e574c2025dbc7e6f8">inputlist::lrzaxis</a>, <a class="el" href="group__grp__global__numerics.html#ga97e088546c5718d24d5c73ae3b26b306">inputlist::lsparse</a>, <a class="el" href="group__grp__global__numerics.html#gac6b78d4cc8e0a2b1cf22f54bfedef9fa">inputlist::lsvdiota</a>, <a class="el" href="group__grp__global__diagnostics.html#ga8c7855bc531248be61f8f71ac402ea54">inputlist::ltiming</a>, <a class="el" href="group__grp__global__diagnostics.html#gab49430984a262fca5e90ad7d69b3acf4">inputlist::ltransform</a>, <a class="el" href="group__grp__global__numerics.html#ga25c24200f09c2dcb39957f3a8bc71742">inputlist::lzerovac</a>, <a class="el" href="group__grp__global__local.html#ga30d44327f3ec90d9d8b8416a4587d7df">inputlist::maxrndgues</a>, <a class="el" href="group__grp__global__global.html#gac711f17e710c4216eb9423c0f6e3b5aa">inputlist::mcasingcal</a>, <a class="el" href="group__grp__global__global.html#ga10b2732b4273e84e78e7768d965e7436">inputlist::mfreeits</a>, <a class="el" href="group__grp__global__physicslist.html#ga37922639dc82622c797f406474d1087a">inputlist::mpol</a>, <a class="el" href="group__grp__global__numerics.html#ga4da1b0c06c88a8c6a07586873284e126">inputlist::mregular</a>, <a class="el" href="group__grp__global__physicslist.html#ga434a83d47ab8804a8c88e9e09f194bf2">inputlist::mu</a>, <a class="el" href="group__grp__global__physicslist.html#gab73e88fa3cc713559c1db45ddbe1f8f3">inputlist::mupfits</a>, <a class="el" href="group__grp__global__physicslist.html#ga56f5897e566d4d487fbdf6a45e248c91">inputlist::mupftol</a>, <a class="el" href="namespaceallglobal.html#aa2a4850f9468d817a673c1ef7f718849">allglobal::mvol</a>, <a class="el" href="namespaceallglobal.html#aca1163f9aab48251a99d00e63618cc39">allglobal::myid</a>, <a class="el" href="group__grp__global__numerics.html#ga8a13fd57376bbfa5f25313a1a9ca8e70">inputlist::ndiscrete</a>, <a class="el" href="group__grp__global__physicslist.html#gae071c5738f7f7a6ada9d6b66676e37c7">inputlist::nfp</a>, <a class="el" href="group__grp__global__diagnostics.html#ga56b8079bfa338e976ae73476fabb28bf">inputlist::ngrid</a>, <a class="el" href="group__grp__global__diagnostics.html#ga1352151a16c55ca06c613474753e4acc">inputlist::nppts</a>, <a class="el" href="group__grp__global__diagnostics.html#ga43f97d12fb946e52880568090f5ebf88">inputlist::nptrj</a>, <a class="el" href="group__grp__global__numerics.html#ga604fecd2de50b586f3b6f3577bfe1f6f">inputlist::nquad</a>, <a class="el" href="group__grp__global__physicslist.html#ga44cde2d69503cc15bb6f31349d2900a6">inputlist::ntor</a>, <a class="el" href="group__grp__global__numerics.html#ga3a7155b4013c5faeb0683befe1c56549">inputlist::ntoraxis</a>, <a class="el" href="group__grp__global__physicslist.html#gafdbe1fac5fd98bb41ae5cc363ab9aedd">inputlist::nvol</a>, <a class="el" href="group__grp__global__diagnostics.html#ga62fe17fdae41361dfa29f54c02a80947">inputlist::odetol</a>, <a class="el" href="group__grp__global__physicslist.html#ga5c632325f392b4408f2960d58d981346">inputlist::oita</a>, <a class="el" href="group__grp__global__global.html#gadd27ef1a6a922867ed60c7b61f28328c">inputlist::opsilon</a>, <a class="el" href="group__grp__global__global.html#gaf4fb44aa6d26486741147e950a0bde0b">inputlist::pcondense</a>, <a class="el" href="group__grp__global__physicslist.html#ga1d7cc174857156ba5e880eddbe25b65b">inputlist::pflux</a>, <a class="el" href="group__grp__global__physicslist.html#ga31b9257e6356b1591fbc63e618c74c2b">inputlist::phiedge</a>, <a class="el" href="group__grp__global__physicslist.html#ga610b4b813924dbb2698846cc4e1a489d">inputlist::pl</a>, <a class="el" href="group__grp__global__diagnostics.html#ga62a8e3ce3aa95a59442634da01eae18f">inputlist::ppts</a>, <a class="el" href="group__grp__global__physicslist.html#ga5122d7875e1b985d49dba2a6ae6523b7">inputlist::pr</a>, <a class="el" href="group__grp__global__physicslist.html#ga1bec66b8a5f59fee9529ca04eb29202a">inputlist::pressure</a>, <a class="el" href="group__grp__global__physicslist.html#ga89fd8fbe67af2b8e72dbcb9440c7b797">inputlist::pscale</a>, <a class="el" href="group__grp__global__physicslist.html#ga2cc3fa9ba658f66eac67d3ca54dbe58a">inputlist::ql</a>, <a class="el" href="group__grp__global__physicslist.html#ga8af734c40853f8ba531951a48fd08a1d">inputlist::qr</a>, <a class="el" href="group__grp__global__physicslist.html#gab40ba407d54c1f54012666143dff9c7e">inputlist::rac</a>, <a class="el" href="group__grp__global__physicslist.html#gaffe647c3e4f7c39fef763d863e1f7eb8">inputlist::ras</a>, <a class="el" href="group__grp__global__physicslist.html#ga82c7ae2283ae9fc8d8a6e23ce1d3f696">inputlist::rbc</a>, <a class="el" href="group__grp__global__physicslist.html#gaae55325d404aa5088957b91085763ddb">inputlist::rbs</a>, <a class="el" href="group__grp__global__diagnostics.html#ga0b784f7c68bb8a23177be951b9a38ae3">inputlist::relreq</a>, <a class="el" href="group__grp__global__physicslist.html#gaa9a5ce4cc93d681387897025114ea0fe">inputlist::rp</a>, <a class="el" href="group__grp__global__physicslist.html#ga37c9a7d78ef71df251141cae0c8ec93f">inputlist::rpol</a>, <a class="el" href="group__grp__global__physicslist.html#ga6ca20c6571e6f9339af9ef64ccb68eed">inputlist::rq</a>, <a class="el" href="group__grp__global__physicslist.html#gab91e2139a3fc291c9e16fc9c26e1e0aa">inputlist::rtor</a>, <a class="el" href="group__grp__global__physicslist.html#gaaf9b00e769991c15c9caa4b284456739">inputlist::rwc</a>, <a class="el" href="group__grp__global__physicslist.html#gabba5bdf1a32511287638088fc911378e">inputlist::rws</a>, <a class="el" href="group__grp__global__diagnostics.html#ga6c30950013a3a513aad46ef0d53563d0">inputlist::scaling</a>, <a class="el" href="group__grp__global__physicslist.html#ga5616f18d1b18821a3f6ce6542a0d53d0">inputlist::tflux</a>, <a class="el" href="group__grp__global__global.html#ga515611bab98c724906d8827582d86c2d">inputlist::upsilon</a>, <a class="el" href="group__grp__global__global.html#gae24f9ecfcf665ca7fee4fc256a6ee6b9">inputlist::vcasingeps</a>, <a class="el" href="group__grp__global__global.html#ga2f2dde390fc9fa59a6571e06fc355a60">inputlist::vcasingits</a>, <a class="el" href="group__grp__global__global.html#gac2a4a9b2a184ba33475c40f94347f66b">inputlist::vcasingper</a>, <a class="el" href="group__grp__global__global.html#ga02f23f7f95485f63c4ab9c8c14669cd3">inputlist::vcasingtol</a>, <a class="el" href="group__grp__global__physicslist.html#ga65d0c8b5df586e3080c880a8234c3de8">inputlist::vnc</a>, <a class="el" href="group__grp__global__physicslist.html#gaa980166e627b0166d5a020973fccfdf8">inputlist::vns</a>, <a class="el" href="group__grp__volume.html#gae4c62d20b8fef07f4471b5b0889ab005">volume()</a>, <a class="el" href="group__grp__global__global.html#gace3de832a0b5616ddc92f583510b2401">inputlist::wpoloidal</a>, <a class="el" href="group__grp__global__physicslist.html#ga1993660551636d615dbeeb8ceb022e2d">inputlist::zac</a>, <a class="el" href="group__grp__global__physicslist.html#gaee94d890116ffd2e7dfa30387d1d123d">inputlist::zas</a>, <a class="el" href="group__grp__global__physicslist.html#gaa5c20328ddf092f3e8c48f5591bdb7e1">inputlist::zbc</a>, <a class="el" href="group__grp__global__physicslist.html#gab1fba948fc7acbbdf91c00cc91efb30d">inputlist::zbs</a>, <a class="el" href="group__grp__global__physicslist.html#gae4c44337fcc32a5414eb57b88f98afdf">inputlist::zwc</a>, and <a class="el" href="group__grp__global__physicslist.html#ga5c7ff6b50a435bb096f9e53b5828bcda">inputlist::zws</a>.</p>

<p class="reference">Referenced by <a class="el" href="xspech_8f90.html#a9fdc71dffd7c61ee4588a3f80d3ab9ce">xspech()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_gafed4d951aec99f2ebeba68c465eb9861_cgraph.svg" width="367" height="70"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_gafed4d951aec99f2ebeba68c465eb9861_icgraph.svg" width="1223" height="510"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="gab348ec00943ff875a1ebb965fb98841e" name="gab348ec00943ff875a1ebb965fb98841e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab348ec00943ff875a1ebb965fb98841e">&#9670;&nbsp;</a></span>init_convergence_output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sphdf5::init_convergence_output</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepare convergence evolution output. </p>
<ul>
<li>
The group <code>iterations</code> is created in the output file. This group contains the interface geometry at each iteration, which is useful for constructing movies illustrating the convergence. The data structure in use is an unlimited array of the following compound datatype: <div class="fragment"><div class="line">DATATYPE  H5T_COMPOUND {</div>
<div class="line">      H5T_NATIVE_INTEGER <span class="stringliteral">&quot;nDcalls&quot;</span>;</div>
<div class="line">      H5T_NATIVE_DOUBLE <span class="stringliteral">&quot;Energy&quot;</span>;</div>
<div class="line">      H5T_NATIVE_DOUBLE <span class="stringliteral">&quot;ForceErr&quot;</span>;</div>
<div class="line">      H5T_ARRAY { [Mvol+1][<a class="code hl_variable" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400" title="total number of Fourier harmonics for coordinates/fields; calculated from Mpol, Ntor in readin()">mn</a>] H5T_NATIVE_DOUBLE } <span class="stringliteral">&quot;iRbc&quot;</span>;</div>
<div class="line">      H5T_ARRAY { [Mvol+1][<a class="code hl_variable" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400" title="total number of Fourier harmonics for coordinates/fields; calculated from Mpol, Ntor in readin()">mn</a>] H5T_NATIVE_DOUBLE } <span class="stringliteral">&quot;iZbs&quot;</span>;</div>
<div class="line">      H5T_ARRAY { [Mvol+1][<a class="code hl_variable" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400" title="total number of Fourier harmonics for coordinates/fields; calculated from Mpol, Ntor in readin()">mn</a>] H5T_NATIVE_DOUBLE } <span class="stringliteral">&quot;iRbs&quot;</span>;</div>
<div class="line">      H5T_ARRAY { [Mvol+1][<a class="code hl_variable" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400" title="total number of Fourier harmonics for coordinates/fields; calculated from Mpol, Ntor in readin()">mn</a>] H5T_NATIVE_DOUBLE } <span class="stringliteral">&quot;iZbc&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->  </li>
</ul>

<p class="reference">References <a class="el" href="namespacesphdf5.html#a3bcbd1694c419de09006aea7083d2b14">sphdf5::dt_energy_id</a>, <a class="el" href="namespacesphdf5.html#a8de582a1dd644b759b95eb7421c92909">sphdf5::dt_forceerr_id</a>, <a class="el" href="namespacesphdf5.html#aea8f8c1cd2822689519e2e9afea75d9b">sphdf5::dt_irbc_id</a>, <a class="el" href="namespacesphdf5.html#a408867ce41bd3a4a323610d02fd3dc04">sphdf5::dt_irbs_id</a>, <a class="el" href="namespacesphdf5.html#a3295ae5329149280f51fc5a7f7758931">sphdf5::dt_izbc_id</a>, <a class="el" href="namespacesphdf5.html#a7ab23358d53bece2eae4a8f1f44ac3e9">sphdf5::dt_izbs_id</a>, <a class="el" href="namespacesphdf5.html#a6121cc9aa463a17d13ae4a92bc0d3f2d">sphdf5::dt_ndcalls_id</a>, <a class="el" href="namespacesphdf5.html#a5ebb9276a31deb0bcbe482da78f4b5b2">sphdf5::file_id</a>, <a class="el" href="namespacesphdf5.html#a5d3c610c372abd4fd4d68576ef0d3726">sphdf5::hdfier</a>, <a class="el" href="namespacesphdf5.html#af83b972e01fc15bdc717069ea3cd392e">sphdf5::iteration_dset_id</a>, <a class="el" href="namespacesphdf5.html#aa96bc9bde78aefa532fbf91e95c552a4">sphdf5::memspace</a>, <a class="el" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400">allglobal::mn</a>, <a class="el" href="namespaceallglobal.html#aa2a4850f9468d817a673c1ef7f718849">allglobal::mvol</a>, <a class="el" href="namespaceallglobal.html#aca1163f9aab48251a99d00e63618cc39">allglobal::myid</a>, and <a class="el" href="namespacesphdf5.html#ab321e648ea08a1f2e76fc7f3303869d6">sphdf5::plist_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="xspech_8f90.html#a9fdc71dffd7c61ee4588a3f80d3ab9ce">xspech()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_gab348ec00943ff875a1ebb965fb98841e_icgraph.svg" width="1254" height="510"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="gade76c03b9b11be2a12d3ddd32e77a6ae" name="gade76c03b9b11be2a12d3ddd32e77a6ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gade76c03b9b11be2a12d3ddd32e77a6ae">&#9670;&nbsp;</a></span>write_convergence_output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sphdf5::write_convergence_output </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nDcalls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ForceErr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write convergence output (evolution of interface geometry, force, etc). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nDcalls</td><td>number of calls to get derivative values </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ForceErr</td><td>total force-imbalance (accessible from allglobal) </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="namespacesphdf5.html#a28b56e748f3578456883f5ae382b7237">sphdf5::data_dims</a>, <a class="el" href="namespacesphdf5.html#ac2f8bfefd6a0cc6784262480418d6f2b">sphdf5::dataspace</a>, <a class="el" href="namespacesphdf5.html#a3bcbd1694c419de09006aea7083d2b14">sphdf5::dt_energy_id</a>, <a class="el" href="namespacesphdf5.html#a8de582a1dd644b759b95eb7421c92909">sphdf5::dt_forceerr_id</a>, <a class="el" href="namespacesphdf5.html#aea8f8c1cd2822689519e2e9afea75d9b">sphdf5::dt_irbc_id</a>, <a class="el" href="namespacesphdf5.html#a408867ce41bd3a4a323610d02fd3dc04">sphdf5::dt_irbs_id</a>, <a class="el" href="namespacesphdf5.html#a3295ae5329149280f51fc5a7f7758931">sphdf5::dt_izbc_id</a>, <a class="el" href="namespacesphdf5.html#a7ab23358d53bece2eae4a8f1f44ac3e9">sphdf5::dt_izbs_id</a>, <a class="el" href="namespacesphdf5.html#a6121cc9aa463a17d13ae4a92bc0d3f2d">sphdf5::dt_ndcalls_id</a>, <a class="el" href="namespaceallglobal.html#a07f3f4df2aaac1b26a68b04a2c4464d6">allglobal::energy</a>, <a class="el" href="namespacesphdf5.html#a5d3c610c372abd4fd4d68576ef0d3726">sphdf5::hdfier</a>, <a class="el" href="group__grp__iface__geom.html#ga9f6e014546551429956a2a47c134d07b">allglobal::irbc</a>, <a class="el" href="group__grp__iface__geom.html#ga05ba18442623cf5f34f7a2193a03e0b1">allglobal::irbs</a>, <a class="el" href="namespacesphdf5.html#af83b972e01fc15bdc717069ea3cd392e">sphdf5::iteration_dset_id</a>, <a class="el" href="group__grp__iface__geom.html#ga6c7ad3b18081227f992e4c3e73a2e216">allglobal::izbc</a>, <a class="el" href="group__grp__iface__geom.html#gadcc12f5e32287fd4b60dc01afc6e64d2">allglobal::izbs</a>, <a class="el" href="namespacesphdf5.html#a04cdba99067381030129162979f8d63c">sphdf5::max_dims</a>, <a class="el" href="namespacesphdf5.html#aa96bc9bde78aefa532fbf91e95c552a4">sphdf5::memspace</a>, <a class="el" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400">allglobal::mn</a>, <a class="el" href="namespaceallglobal.html#aa2a4850f9468d817a673c1ef7f718849">allglobal::mvol</a>, <a class="el" href="namespaceallglobal.html#aca1163f9aab48251a99d00e63618cc39">allglobal::myid</a>, <a class="el" href="namespacesphdf5.html#a9110951adf8bcaf9b10804ac513f87ca">sphdf5::old_data_dims</a>, <a class="el" href="namespacesphdf5.html#ab321e648ea08a1f2e76fc7f3303869d6">sphdf5::plist_id</a>, and <a class="el" href="namespacesphdf5.html#ab733596bbc4663c4a8e798a1014b9690">sphdf5::rank</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__grp__force__driver.html#gabbc245b3884ee8d8d3e2a52f25149f78">fcn1()</a>, and <a class="el" href="group__grp__force__driver.html#ga8ccd6c7d901872702521d0a0edf95412">fcn2()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_gade76c03b9b11be2a12d3ddd32e77a6ae_icgraph.svg" width="1230" height="502"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ga17e65b951634f7098213fd071d905482" name="ga17e65b951634f7098213fd071d905482"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga17e65b951634f7098213fd071d905482">&#9670;&nbsp;</a></span>write_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sphdf5::write_grid</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write the magnetic field on a grid. </p>
<p >The magnetic field is evaluated on a regular grid in \((s, \theta, \zeta)\) and the corresponding cylindrical coordinates \((R,Z)\) as well as the cylindrical components of the magnetic field \((B^R, B^\varphi, B^Z)\) are written out. </p>

<p class="reference">References <a class="el" href="group__grp__diagnostics.html#ga20985df1b0df0503ca03ca13f1daf642">bfield()</a>, <a class="el" href="group__grp__geometry.html#gaaca20aa60eaf39055f3c9d5c02a24ac2">coords()</a>, <a class="el" href="namespacesphdf5.html#a5ebb9276a31deb0bcbe482da78f4b5b2">sphdf5::file_id</a>, <a class="el" href="group__grp__int__global.html#ga2fac3fe3801a9c4ed8bbbf1b2084251f">allglobal::gbzeta</a>, <a class="el" href="group__grp__global__physicslist.html#gaa6dcbfd2f5cb5f23f4bc567fb13ae0e2">inputlist::igeometry</a>, <a class="el" href="group__grp__fourier__transform.html#ga61de5564536d1d82a7248c7052fe8de2">allglobal::ijimag</a>, <a class="el" href="group__grp__fourier__transform.html#ga16a474ec37a253d5b4477d6b7f4da9ff">allglobal::ijreal</a>, <a class="el" href="group__grp__int__global.html#ga5b54d328b765f18e964d3f75d8e1c06b">allglobal::ivol</a>, <a class="el" href="group__grp__fourier__transform.html#ga5d6c2633274202e97562b9d81c836e40">allglobal::jireal</a>, <a class="el" href="group__grp__vecpot.html#gad6a2a40a248c2d81155a94b2dfe9b480">allglobal::lcoordinatesingularity</a>, <a class="el" href="group__grp__vecpot.html#gabec56b2849c2ea1b35bf0503d373d849">allglobal::lplasmaregion</a>, <a class="el" href="group__grp__global__physicslist.html#ga1509b6ce73e909b86beaf65c26527932">inputlist::lrad</a>, <a class="el" href="group__grp__vecpot.html#ga1f7f9baf38f833eb5f5318408c5407ac">allglobal::lvacuumregion</a>, <a class="el" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400">allglobal::mn</a>, <a class="el" href="namespaceallglobal.html#aa2a4850f9468d817a673c1ef7f718849">allglobal::mvol</a>, <a class="el" href="namespaceallglobal.html#aca1163f9aab48251a99d00e63618cc39">allglobal::myid</a>, <a class="el" href="group__grp__global__diagnostics.html#ga56b8079bfa338e976ae73476fabb28bf">inputlist::ngrid</a>, <a class="el" href="group__grp__misc.html#gab7fcbb69b32272304509d6c817d84474">allglobal::node</a>, <a class="el" href="group__grp__fourier__transform.html#ga2a7d2dbc4637d792e1eeabcd4ee5564e">allglobal::nt</a>, <a class="el" href="group__grp__fourier__transform.html#ga369408d2dce5e4b64b7bf73699367b32">allglobal::ntz</a>, <a class="el" href="group__grp__global__physicslist.html#gafdbe1fac5fd98bb41ae5cc363ab9aedd">inputlist::nvol</a>, <a class="el" href="group__grp__fourier__transform.html#gaa91566c55f28df38e46ffc19e60f766f">allglobal::nz</a>, <a class="el" href="namespaceconstants.html#ad5224c0b5e13bf12b18dafbb62ba4e8d">constants::one</a>, <a class="el" href="namespaceconstants.html#a4fad0dab629c84331119053f1ec1348d">constants::pi2</a>, <a class="el" href="namespaceallglobal.html#aae9519af29ff59bac4ff2232d930f409">allglobal::pi2nfp</a>, <a class="el" href="group__grp__fourier__transform.html#ga8f081a0f8a483bce45d274c64016e3eb">allglobal::rij</a>, <a class="el" href="group__grp__global__physicslist.html#ga37c9a7d78ef71df251141cae0c8ec93f">inputlist::rpol</a>, <a class="el" href="group__grp__global__physicslist.html#gab91e2139a3fc291c9e16fc9c26e1e0aa">inputlist::rtor</a>, <a class="el" href="group__grp__fourier__transform.html#ga4b1c60e25eab68b6372bf28f84aecc97">allglobal::sg</a>, <a class="el" href="namespaceconstants.html#a77f9c93617de9c40ab41a50a157fb90d">constants::two</a>, <a class="el" href="namespaceconstants.html#ab2b0340319f61089513f5dd1d3971a47">constants::zero</a>, and <a class="el" href="group__grp__fourier__transform.html#ga441f64569bbbf93b31c1e1f2347bc2a8">allglobal::zij</a>.</p>

<p class="reference">Referenced by <a class="el" href="xspech_8f90.html#a9fdc71dffd7c61ee4588a3f80d3ab9ce">xspech()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_ga17e65b951634f7098213fd071d905482_cgraph.svg" width="379" height="163"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_ga17e65b951634f7098213fd071d905482_icgraph.svg" width="1211" height="510"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ga47186186c9418cd913ee9c98b5668642" name="ga47186186c9418cd913ee9c98b5668642"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga47186186c9418cd913ee9c98b5668642">&#9670;&nbsp;</a></span>init_flt_output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sphdf5::init_flt_output </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>numTrajTotal</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize field line tracing output group and create array datasets. </p>
<p >The field-line tracing diagnostic is parallelized over volumes, where all threads/ranks produce individual output. This is gathered in the output file, stacked over the radial dimension. The <code>success</code> flag signals if the integrator was successful in following the fieldline for the derired number of toroidal periods.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">numTrajTotal</td><td>total number of Poincare trajectories </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="namespacesphdf5.html#affd20b49a682785ec2fa48c81167607b">sphdf5::dset_id_diotadxup</a>, <a class="el" href="namespacesphdf5.html#a503f770bb162621cfa369922c04282e8">sphdf5::dset_id_fiota</a>, <a class="el" href="namespacesphdf5.html#aa61c791364563059d731c7c20458f55f">sphdf5::dset_id_r</a>, <a class="el" href="namespacesphdf5.html#af735aa2479d9c22f989c26ae9563f32e">sphdf5::dset_id_s</a>, <a class="el" href="namespacesphdf5.html#af2f4e7f97ed94439c472bad084d3b916">sphdf5::dset_id_success</a>, <a class="el" href="namespacesphdf5.html#a34c8921189a3a5764df31709ec0b2e9b">sphdf5::dset_id_t</a>, <a class="el" href="namespacesphdf5.html#a27109e3805b8e5855c89caa32c20783f">sphdf5::dset_id_z</a>, <a class="el" href="namespacesphdf5.html#a5ebb9276a31deb0bcbe482da78f4b5b2">sphdf5::file_id</a>, <a class="el" href="namespacesphdf5.html#af5c1be99fcf8b487d6a44ad9efd17cd0">sphdf5::filespace_diotadxup</a>, <a class="el" href="namespacesphdf5.html#ae0ae88a7655d16337c8eef62464538af">sphdf5::filespace_fiota</a>, <a class="el" href="namespacesphdf5.html#ac044da6c791e1cd46b1ff9ce13eaad13">sphdf5::filespace_r</a>, <a class="el" href="namespacesphdf5.html#ab0a49bfbd7b84b0d427e9cacbf9c8533">sphdf5::filespace_s</a>, <a class="el" href="namespacesphdf5.html#a3a8e24b4cc609f7f5fb91d5e1e15973f">sphdf5::filespace_success</a>, <a class="el" href="namespacesphdf5.html#a98d088d91590a7334ffbeb4b0167b0c6">sphdf5::filespace_t</a>, <a class="el" href="namespacesphdf5.html#a8fe47791325a0b00c0d6d41baf30c9f0">sphdf5::filespace_z</a>, <a class="el" href="namespacesphdf5.html#a8aa2c9b5d0238aaf1842bb115a72d5b4">sphdf5::grppoincare</a>, <a class="el" href="namespacesphdf5.html#a7d3acffac1aa1c086a71dac56b026ebc">sphdf5::grptransform</a>, <a class="el" href="namespacesphdf5.html#a5d3c610c372abd4fd4d68576ef0d3726">sphdf5::hdfier</a>, <a class="el" href="group__grp__field__matrices.html#ga9a50861390cbd5e6dab0378e56377d93">allglobal::lmns</a>, <a class="el" href="namespacesphdf5.html#ab0ebd0361b9856beacb3b5683c2f8c6e">sphdf5::memspace_diotadxup</a>, <a class="el" href="namespacesphdf5.html#add03fc963ec90d8c74df8ef0cea0451b">sphdf5::memspace_r</a>, <a class="el" href="namespacesphdf5.html#ac7c0f9df7cd63c2091b214043d669dbd">sphdf5::memspace_s</a>, <a class="el" href="namespacesphdf5.html#aead22bcfdccedc28232496c2fd5684a8">sphdf5::memspace_success</a>, <a class="el" href="namespacesphdf5.html#a9a625748fd5252893c741db036e2dff1">sphdf5::memspace_t</a>, <a class="el" href="namespacesphdf5.html#acf75db08fd540b0523580522ea4c4eef">sphdf5::memspace_z</a>, <a class="el" href="namespaceallglobal.html#aa2a4850f9468d817a673c1ef7f718849">allglobal::mvol</a>, <a class="el" href="namespaceallglobal.html#aca1163f9aab48251a99d00e63618cc39">allglobal::myid</a>, <a class="el" href="group__grp__global__diagnostics.html#ga1352151a16c55ca06c613474753e4acc">inputlist::nppts</a>, <a class="el" href="group__grp__fourier__transform.html#gaa91566c55f28df38e46ffc19e60f766f">allglobal::nz</a>, <a class="el" href="namespacesphdf5.html#a32baad755745f450c2c0df28d93b214d">sphdf5::rankp</a>, and <a class="el" href="namespacesphdf5.html#a0c62896edb439e7c04d414d94883a6c4">sphdf5::rankt</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__grp__diagnostics.html#gad67931244268a09bd077dae8910c7096">pp00aa()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_ga47186186c9418cd913ee9c98b5668642_icgraph.svg" width="1478" height="499"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ga14195bd206b7f6a7f05d4d6fc4b50f42" name="ga14195bd206b7f6a7f05d4d6fc4b50f42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga14195bd206b7f6a7f05d4d6fc4b50f42">&#9670;&nbsp;</a></span>write_poincare()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sphdf5::write_poincare </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>success</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write a hyperslab of Poincare data corresponding to the output of one parallel worker. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offset</td><td>radial offset at which the data belongs </td></tr>
    <tr><td class="paramname">data</td><td>output from field-line tracing </td></tr>
    <tr><td class="paramname">success</td><td>flags to indicate if integrator was successful </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="namespacesphdf5.html#aa61c791364563059d731c7c20458f55f">sphdf5::dset_id_r</a>, <a class="el" href="namespacesphdf5.html#af735aa2479d9c22f989c26ae9563f32e">sphdf5::dset_id_s</a>, <a class="el" href="namespacesphdf5.html#af2f4e7f97ed94439c472bad084d3b916">sphdf5::dset_id_success</a>, <a class="el" href="namespacesphdf5.html#a34c8921189a3a5764df31709ec0b2e9b">sphdf5::dset_id_t</a>, <a class="el" href="namespacesphdf5.html#a27109e3805b8e5855c89caa32c20783f">sphdf5::dset_id_z</a>, <a class="el" href="namespacesphdf5.html#ac044da6c791e1cd46b1ff9ce13eaad13">sphdf5::filespace_r</a>, <a class="el" href="namespacesphdf5.html#ab0a49bfbd7b84b0d427e9cacbf9c8533">sphdf5::filespace_s</a>, <a class="el" href="namespacesphdf5.html#a3a8e24b4cc609f7f5fb91d5e1e15973f">sphdf5::filespace_success</a>, <a class="el" href="namespacesphdf5.html#a98d088d91590a7334ffbeb4b0167b0c6">sphdf5::filespace_t</a>, <a class="el" href="namespacesphdf5.html#a8fe47791325a0b00c0d6d41baf30c9f0">sphdf5::filespace_z</a>, <a class="el" href="namespacesphdf5.html#a5d3c610c372abd4fd4d68576ef0d3726">sphdf5::hdfier</a>, <a class="el" href="namespacesphdf5.html#add03fc963ec90d8c74df8ef0cea0451b">sphdf5::memspace_r</a>, <a class="el" href="namespacesphdf5.html#ac7c0f9df7cd63c2091b214043d669dbd">sphdf5::memspace_s</a>, <a class="el" href="namespacesphdf5.html#aead22bcfdccedc28232496c2fd5684a8">sphdf5::memspace_success</a>, <a class="el" href="namespacesphdf5.html#a9a625748fd5252893c741db036e2dff1">sphdf5::memspace_t</a>, <a class="el" href="namespacesphdf5.html#acf75db08fd540b0523580522ea4c4eef">sphdf5::memspace_z</a>, <a class="el" href="namespaceallglobal.html#aca1163f9aab48251a99d00e63618cc39">allglobal::myid</a>, <a class="el" href="group__grp__global__diagnostics.html#ga1352151a16c55ca06c613474753e4acc">inputlist::nppts</a>, and <a class="el" href="group__grp__fourier__transform.html#gaa91566c55f28df38e46ffc19e60f766f">allglobal::nz</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__grp__diagnostics.html#gad67931244268a09bd077dae8910c7096">pp00aa()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_ga14195bd206b7f6a7f05d4d6fc4b50f42_icgraph.svg" width="1484" height="499"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ga8f01c5e4a21c5af2c39620f24e598095" name="ga8f01c5e4a21c5af2c39620f24e598095"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8f01c5e4a21c5af2c39620f24e598095">&#9670;&nbsp;</a></span>write_transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sphdf5::write_transform </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lvol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>diotadxup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>fiota</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write the rotational transform output from field line following. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offset</td><td>radial offset at which the data belongs </td></tr>
    <tr><td class="paramname">length</td><td>length of dataset to write </td></tr>
    <tr><td class="paramname">lvol</td><td>nested volume index </td></tr>
    <tr><td class="paramname">diotadxup</td><td>derivative of rotational transform (?) </td></tr>
    <tr><td class="paramname">fiota</td><td>rotational transform </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="namespacesphdf5.html#affd20b49a682785ec2fa48c81167607b">sphdf5::dset_id_diotadxup</a>, <a class="el" href="namespacesphdf5.html#a503f770bb162621cfa369922c04282e8">sphdf5::dset_id_fiota</a>, <a class="el" href="namespacesphdf5.html#af5c1be99fcf8b487d6a44ad9efd17cd0">sphdf5::filespace_diotadxup</a>, <a class="el" href="namespacesphdf5.html#ae0ae88a7655d16337c8eef62464538af">sphdf5::filespace_fiota</a>, <a class="el" href="namespacesphdf5.html#a5d3c610c372abd4fd4d68576ef0d3726">sphdf5::hdfier</a>, <a class="el" href="namespacesphdf5.html#ab0ebd0361b9856beacb3b5683c2f8c6e">sphdf5::memspace_diotadxup</a>, <a class="el" href="namespacesphdf5.html#a0433087900600ccdd17875e8562621a9">sphdf5::memspace_fiota</a>, and <a class="el" href="namespacesphdf5.html#a0c62896edb439e7c04d414d94883a6c4">sphdf5::rankt</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__grp__diagnostics.html#gad67931244268a09bd077dae8910c7096">pp00aa()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_ga8f01c5e4a21c5af2c39620f24e598095_icgraph.svg" width="1491" height="499"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="gacd97a933d4239028dc8114b110655074" name="gacd97a933d4239028dc8114b110655074"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacd97a933d4239028dc8114b110655074">&#9670;&nbsp;</a></span>finalize_flt_output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sphdf5::finalize_flt_output</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finalize Poincare output. </p>
<p >This closes the still-open datasets related to field-line tracing, which had to be kept open during the tracing to be able to write the outputs directly when a given worker thread is finished. </p>

<p class="reference">References <a class="el" href="namespacesphdf5.html#affd20b49a682785ec2fa48c81167607b">sphdf5::dset_id_diotadxup</a>, <a class="el" href="namespacesphdf5.html#a503f770bb162621cfa369922c04282e8">sphdf5::dset_id_fiota</a>, <a class="el" href="namespacesphdf5.html#aa61c791364563059d731c7c20458f55f">sphdf5::dset_id_r</a>, <a class="el" href="namespacesphdf5.html#af735aa2479d9c22f989c26ae9563f32e">sphdf5::dset_id_s</a>, <a class="el" href="namespacesphdf5.html#af2f4e7f97ed94439c472bad084d3b916">sphdf5::dset_id_success</a>, <a class="el" href="namespacesphdf5.html#a34c8921189a3a5764df31709ec0b2e9b">sphdf5::dset_id_t</a>, <a class="el" href="namespacesphdf5.html#a27109e3805b8e5855c89caa32c20783f">sphdf5::dset_id_z</a>, <a class="el" href="namespacesphdf5.html#af5c1be99fcf8b487d6a44ad9efd17cd0">sphdf5::filespace_diotadxup</a>, <a class="el" href="namespacesphdf5.html#ae0ae88a7655d16337c8eef62464538af">sphdf5::filespace_fiota</a>, <a class="el" href="namespacesphdf5.html#ac044da6c791e1cd46b1ff9ce13eaad13">sphdf5::filespace_r</a>, <a class="el" href="namespacesphdf5.html#ab0a49bfbd7b84b0d427e9cacbf9c8533">sphdf5::filespace_s</a>, <a class="el" href="namespacesphdf5.html#a3a8e24b4cc609f7f5fb91d5e1e15973f">sphdf5::filespace_success</a>, <a class="el" href="namespacesphdf5.html#a98d088d91590a7334ffbeb4b0167b0c6">sphdf5::filespace_t</a>, <a class="el" href="namespacesphdf5.html#a8fe47791325a0b00c0d6d41baf30c9f0">sphdf5::filespace_z</a>, <a class="el" href="namespacesphdf5.html#a8aa2c9b5d0238aaf1842bb115a72d5b4">sphdf5::grppoincare</a>, <a class="el" href="namespacesphdf5.html#a7d3acffac1aa1c086a71dac56b026ebc">sphdf5::grptransform</a>, <a class="el" href="namespacesphdf5.html#a5d3c610c372abd4fd4d68576ef0d3726">sphdf5::hdfier</a>, <a class="el" href="namespacesphdf5.html#ab0ebd0361b9856beacb3b5683c2f8c6e">sphdf5::memspace_diotadxup</a>, <a class="el" href="namespacesphdf5.html#add03fc963ec90d8c74df8ef0cea0451b">sphdf5::memspace_r</a>, <a class="el" href="namespacesphdf5.html#ac7c0f9df7cd63c2091b214043d669dbd">sphdf5::memspace_s</a>, <a class="el" href="namespacesphdf5.html#aead22bcfdccedc28232496c2fd5684a8">sphdf5::memspace_success</a>, <a class="el" href="namespacesphdf5.html#a9a625748fd5252893c741db036e2dff1">sphdf5::memspace_t</a>, and <a class="el" href="namespacesphdf5.html#acf75db08fd540b0523580522ea4c4eef">sphdf5::memspace_z</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__grp__diagnostics.html#gad67931244268a09bd077dae8910c7096">pp00aa()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_gacd97a933d4239028dc8114b110655074_icgraph.svg" width="1456" height="499"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ga2f9e9c50084175e5174b1e1070e24d73" name="ga2f9e9c50084175e5174b1e1070e24d73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2f9e9c50084175e5174b1e1070e24d73">&#9670;&nbsp;</a></span>write_vector_potential()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sphdf5::write_vector_potential </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sumLrad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>allAte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>allAze</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>allAto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>allAzo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write the magnetic vector potential Fourier harmonics to the output file group <code>/vector_potential</code> . </p>
<p >The data is stacked in the radial direction over <code>Lrad</code> , since <code>Lrad</code> can be different in each volume, but HDF5 only supports rectangular arrays. So, one needs to split the <code>sumLrad</code> dimension into chunks given by the input <code>Lrad</code> array.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sumLrad</td><td>total sum over <code>Lrad</code> in all nested volumes </td></tr>
    <tr><td class="paramname">allAte</td><td>\(A^{\theta}_\mathrm{even}\) for all nested volumes </td></tr>
    <tr><td class="paramname">allAze</td><td>\(A^{\zeta}_\mathrm{even}\) for all nested volumes </td></tr>
    <tr><td class="paramname">allAto</td><td>\(A^{\theta}_\mathrm{odd}\) for all nested volumes </td></tr>
    <tr><td class="paramname">allAzo</td><td>\(A^{\zeta}_\mathrm{odd}\) for all nested volumes </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="group__grp__vecpot.html#ga430fa6f9a3ebb7a56185b72b8ea1ff49">allglobal::ate</a>, <a class="el" href="group__grp__vecpot.html#gaefec3203c02505c73b48dbb1c7ba96c1">allglobal::ato</a>, <a class="el" href="group__grp__vecpot.html#gad85df9e26321392291e0a43478da0f3c">allglobal::aze</a>, <a class="el" href="group__grp__vecpot.html#gad52dcff52cc620916d5e765051a0228a">allglobal::azo</a>, <a class="el" href="namespacesphdf5.html#a5ebb9276a31deb0bcbe482da78f4b5b2">sphdf5::file_id</a>, <a class="el" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400">allglobal::mn</a>, and <a class="el" href="namespaceallglobal.html#aca1163f9aab48251a99d00e63618cc39">allglobal::myid</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__grp__output.html#ga08d6a254dbc3d9d40ff1cf0bdfdf2148">ra00aa()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_ga2f9e9c50084175e5174b1e1070e24d73_icgraph.svg" width="1372" height="604"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ga593e99355c8ceabe56a566e9d468dbd9" name="ga593e99355c8ceabe56a566e9d468dbd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga593e99355c8ceabe56a566e9d468dbd9">&#9670;&nbsp;</a></span>hdfint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sphdf5::hdfint</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write the final state of the equilibrium to the output file. </p>
<ul>
<li>
<p class="startli">In addition to the input variables, which are described in global(), the following quantities are written to <code>ext.sp.h5</code> :</p>
<p class="endli"></p>
</li>
<li>
All quantities marked as real should be treated as double precision.  </li>
</ul>

<p class="reference">References <a class="el" href="group__grp__global__physicslist.html#ga1b110ff3c17b7dac3af444ab9e42e3d2">inputlist::adiabatic</a>, <a class="el" href="namespaceallglobal.html#a62b3d756309401ae5638d238084719ce">allglobal::beltramierror</a>, <a class="el" href="group__grp__global__physicslist.html#ga3983410e9a76500984fa4a75877315b2">inputlist::bnc</a>, <a class="el" href="group__grp__global__physicslist.html#ga82eafba423cb98f235e79a29a582abd8">inputlist::bns</a>, <a class="el" href="namespaceallglobal.html#a4aae78647d8321706bee7245015e904f">allglobal::bnserr</a>, <a class="el" href="group__grp__fourier__transform.html#gac8cad9694df449349ce766eabd59216d">allglobal::bsupumn</a>, <a class="el" href="group__grp__fourier__transform.html#gad8cb45dc514217d16a651e85749c3185">allglobal::bsupvmn</a>, <a class="el" href="group__grp__covar__field__ifaces.html#ga1f5ea9c38e55707a900ca335990b63f1">allglobal::btemn</a>, <a class="el" href="group__grp__covar__field__ifaces.html#ga81924a77513f01a3ab914cc6d87c9558">allglobal::btomn</a>, <a class="el" href="group__grp__covar__field__ifaces.html#ga01aa29d7089eccad444e36b93b3d0784">allglobal::bzemn</a>, <a class="el" href="group__grp__covar__field__ifaces.html#ga2db512f2492084aac27af4378441be37">allglobal::bzomn</a>, <a class="el" href="namespaceallglobal.html#afae71b580d9f9c71a6796207a5411959">allglobal::cpus</a>, <a class="el" href="group__grp__iface__geom.html#gafa2f03a88e4ba78c9bda1e3bacf9c9e2">allglobal::drbc</a>, <a class="el" href="group__grp__iface__geom.html#gad0e2b0f2bc8714bcaa028f2515417323">allglobal::drbs</a>, <a class="el" href="group__grp__volints.html#ga93e615325c63ed3a2e35edbcf50255d6">allglobal::dvolume</a>, <a class="el" href="group__grp__iface__geom.html#gadf12baed692019acfd4f87edfb30e135">allglobal::dzbc</a>, <a class="el" href="group__grp__iface__geom.html#gad49624ff761950b3d7684815994db03a">allglobal::dzbs</a>, <a class="el" href="namespacesphdf5.html#a5ebb9276a31deb0bcbe482da78f4b5b2">sphdf5::file_id</a>, <a class="el" href="namespaceallglobal.html#a553a5d9f7253b80750db5131b7e5ffef">allglobal::forceerr</a>, <a class="el" href="group__grp__global__physicslist.html#ga46c6c39acda26e483cb0902fabbd8156">inputlist::helicity</a>, <a class="el" href="group__grp__iface__geom.html#gaa5c3bcffd4f21074dd5a496a63489737">allglobal::ibnc</a>, <a class="el" href="group__grp__iface__geom.html#ga9a4fe7e982a7490f6074dd4698c869d6">allglobal::ibns</a>, <a class="el" href="group__grp__fourier__repr.html#gaeac30068003c58add7893688ea2e48aa">allglobal::im</a>, <a class="el" href="group__grp__enh__res__sfl.html#gadee8845cc3c3b0d07b89682b47f2bf61">allglobal::ims</a>, <a class="el" href="group__grp__fourier__repr.html#gae946717d1654463c7cb4b1d7fd712f7d">allglobal::in</a>, <a class="el" href="group__grp__enh__res__sfl.html#ga91fce836682e697629fd780cd9fc4ed9">allglobal::ins</a>, <a class="el" href="group__grp__iface__geom.html#ga9f6e014546551429956a2a47c134d07b">allglobal::irbc</a>, <a class="el" href="group__grp__iface__geom.html#ga05ba18442623cf5f34f7a2193a03e0b1">allglobal::irbs</a>, <a class="el" href="group__grp__iface__geom.html#ga2090710c425371738a7802b5d044ef04">allglobal::ivnc</a>, <a class="el" href="group__grp__iface__geom.html#ga026d4427227376a01e0515e55f15d7f6">allglobal::ivns</a>, <a class="el" href="group__grp__global__physicslist.html#gae5aba6f12ca82ce11c2a577102c64820">inputlist::ivolume</a>, <a class="el" href="group__grp__iface__geom.html#ga6c7ad3b18081227f992e4c3e73a2e216">allglobal::izbc</a>, <a class="el" href="group__grp__iface__geom.html#gadcc12f5e32287fd4b60dc01afc6e64d2">allglobal::izbs</a>, <a class="el" href="group__grp__global__diagnostics.html#ga9bd118017d70e35d658a10463ab4c1dc">inputlist::lcheck</a>, <a class="el" href="group__grp__field__matrices.html#ga9a50861390cbd5e6dab0378e56377d93">allglobal::lmns</a>, <a class="el" href="group__grp__global__diagnostics.html#gaf5f29c4832896ed0a163c214132d2aa2">inputlist::lperturbed</a>, <a class="el" href="group__grp__global__physicslist.html#ga1509b6ce73e909b86beaf65c26527932">inputlist::lrad</a>, <a class="el" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400">allglobal::mn</a>, <a class="el" href="group__grp__enh__res__sfl.html#ga5565369b1327f61841876cf34560e2c1">allglobal::mns</a>, <a class="el" href="group__grp__global__physicslist.html#ga434a83d47ab8804a8c88e9e09f194bf2">inputlist::mu</a>, <a class="el" href="namespaceallglobal.html#aa2a4850f9468d817a673c1ef7f718849">allglobal::mvol</a>, <a class="el" href="namespaceallglobal.html#aca1163f9aab48251a99d00e63618cc39">allglobal::myid</a>, <a class="el" href="namespaceallglobal.html#aa45097c36006ab1ffc0cb06a927ed02a">allglobal::ncpu</a>, <a class="el" href="group__grp__global__physicslist.html#gafdbe1fac5fd98bb41ae5cc363ab9aedd">inputlist::nvol</a>, <a class="el" href="namespacefileunits.html#a7463305b9ff5b4b659d87f6fa59f74a7">fileunits::ounit</a>, <a class="el" href="group__grp__global__physicslist.html#ga1d7cc174857156ba5e880eddbe25b65b">inputlist::pflux</a>, <a class="el" href="group__grp__global__physicslist.html#ga82c7ae2283ae9fc8d8a6e23ce1d3f696">inputlist::rbc</a>, <a class="el" href="group__grp__global__physicslist.html#gaae55325d404aa5088957b91085763ddb">inputlist::rbs</a>, <a class="el" href="group__grp__global__physicslist.html#ga5616f18d1b18821a3f6ce6542a0d53d0">inputlist::tflux</a>, <a class="el" href="namespaceallglobal.html#a0ff41ecfbb162f4712030c7806852615">allglobal::tt</a>, <a class="el" href="group__grp__global__physicslist.html#ga65d0c8b5df586e3080c880a8234c3de8">inputlist::vnc</a>, <a class="el" href="group__grp__global__physicslist.html#gaa980166e627b0166d5a020973fccfdf8">inputlist::vns</a>, <a class="el" href="group__grp__volume.html#gae4c62d20b8fef07f4471b5b0889ab005">volume()</a>, <a class="el" href="group__grp__volints.html#ga8f3eaacd48bc30ec4332e1216213089f">allglobal::vvolume</a>, <a class="el" href="group__grp__global__physicslist.html#gaa5c20328ddf092f3e8c48f5591bdb7e1">inputlist::zbc</a>, and <a class="el" href="group__grp__global__physicslist.html#gab1fba948fc7acbbdf91c00cc91efb30d">inputlist::zbs</a>.</p>

<p class="reference">Referenced by <a class="el" href="xspech_8f90.html#a9fdc71dffd7c61ee4588a3f80d3ab9ce">xspech()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_ga593e99355c8ceabe56a566e9d468dbd9_cgraph.svg" width="331" height="62"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__output_ga593e99355c8ceabe56a566e9d468dbd9_icgraph.svg" width="1187" height="510"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
