<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SPEC: &quot;local&quot; force</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  },
  tex: {
    macros: {},
    packages: ['base','configmacros','amsmath','amssymb']
  }
};
window.MathJax = {
  loader: {
    load: ['[tex]/color', '[tex]/cancel']
  },
  tex: {
      tags: 'ams',
      packages: {'[+]': ['noerrors'],
                 '[+]': ['color'],
                 '[+]': ['verb'],
                 '[+]': ['cancel']
      },
      macros: { bm: ['{\\boldsymbol #1}',1]
      }
  }
};
// https://docs.mathjax.org/en/latest/web/configuration.html#configuring-and-loading-in-one-script
//(function () {
//  var script = document.createElement('script');
//  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js';
//  script.async = true;
//  document.head.appendChild(script);
//})();
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="SPEC_97x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SPEC<span id="projectnumber">&#160;3.20</span>
   </div>
   <div id="projectbrief">Stepped Pressure Equilibrium Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__grp__local__force.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">"local" force</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ga7a5316b9e5eeb42811aa6bccd29a132f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__grp__local__force.html#ga7a5316b9e5eeb42811aa6bccd29a132f">lforce</a> (lvol, iocons, ideriv, Ntz, dBB, XX, YY, length, DDl, MMl, iflag)</td></tr>
<tr class="memdesc:ga7a5316b9e5eeb42811aa6bccd29a132f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes \(B^2\), and the spectral condensation constraints if required, on the interfaces, \({\cal I}_i\).  <a href="group__grp__local__force.html#ga7a5316b9e5eeb42811aa6bccd29a132f">More...</a><br /></td></tr>
<tr class="separator:ga7a5316b9e5eeb42811aa6bccd29a132f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ga7a5316b9e5eeb42811aa6bccd29a132f" name="ga7a5316b9e5eeb42811aa6bccd29a132f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7a5316b9e5eeb42811aa6bccd29a132f">&#9670;&nbsp;</a></span>lforce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lforce </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lvol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iocons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ideriv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>Ntz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(1:ntz, -1:2)&#160;</td>
          <td class="paramname"><em>dBB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(1:ntz)&#160;</td>
          <td class="paramname"><em>XX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(1:ntz)&#160;</td>
          <td class="paramname"><em>YY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(1:ntz)&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>DDl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>MMl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes \(B^2\), and the spectral condensation constraints if required, on the interfaces, \({\cal I}_i\). </p>
<p ><b>field strength</b></p>
<ul>
<li>
The field strength is given by \(B^2 = B^s B_s + B^\theta B_\theta + B^\zeta B_\zeta\), and on the interfaces \(B^s=0\) by construction.  </li>
<li>
The magnetic field is \(\sqrt g \; {\bf B} = (\partial_\theta A_\zeta - \partial_\zeta A_\theta ) {\bf e}_s - \partial_s A_\zeta {\bf e}_\theta + \partial_s A_\theta {\bf e}_\zeta\).  </li>
<li>
The covariant components of the field are computed via \(B_\theta = B^\theta g_{\theta\theta} + B^\zeta g_{\theta\zeta}\) and \(B_\zeta = B^\theta g_{\theta\zeta} + B^\zeta g_{\zeta\zeta}\).  </li>
<li>
The expression for \(B^2\) is <p class="formulaDsp">
\begin{eqnarray} (\sqrt g)^2 B^2 = A_\zeta^\prime \; A_\zeta^\prime \; g_{\theta\theta} - 2 \; A_\zeta^\prime \; A_\theta^\prime \; g_{\theta\zeta} + A_\theta^\prime \; A_\theta^\prime \; g_{\zeta\zeta}, \end{eqnarray}
</p>
 where the \(&quot;\prime&quot;\) denotes derivative with respect to \(s\).  </li>
<li>
The quantity returned is <p class="formulaDsp">
\begin{eqnarray} F \equiv \texttt{pscale} \times \frac{P}{V^\gamma} + \frac{B^2}{2}, \end{eqnarray}
</p>
 where \(P\equiv\) <code>adiabatic</code> and \(V\equiv\) volume.  </li>
</ul>
<p ><b>spectral constraints</b></p>
<ul>
<li>
In addition to the physical-force-balance constraints, namely that \([[p+B^2/2]]=0\) across the interfaces, additional angle constraints are required to obtain a unique Fourier representation of the interface geometry.  </li>
<li>
Introducing the angle functional: a weighted combination of the "polar" constraint; the normalized, poloidal, spectral width (Hirshman &amp; Meier (1985) <a class="el" href="citelist.html#CITEREF_y1985_hirshman">[5]</a>, Hirshman &amp; Breslau (1998) <a class="el" href="citelist.html#CITEREF_y1998_hirshman">[4]</a>) the poloidal-angle origin constraint; and the "length" of the angle curves <p class="formulaDsp">
\begin{eqnarray} F \!\equiv\! \sum_{i=1}^{N-1} \alpha_i \underbrace{\oint\!\!\!\oint \!d\theta d\zeta \,\,\, \!\! \frac{1}{\Theta_{i,\theta}}}_{polar-angle} + \sum_{i=1}^{N-1} \beta_i \, \underbrace{\;\; M_i \;\;}_{spectral-width} + \sum_{i=1}^{N-1} \gamma_i \int_{0}^{2\pi} \! \frac{1}{2}\left[Z_i(0,\zeta)-Z_{i,0}\right]^2 d\zeta + {\color{red}{\oint\!\!\!\oint \!d\theta d\zeta \,\,\, \!\! \sum_{i=1}^{N} \delta_i \, \underbrace{\;\;\;\; L_i \;\;\;\;}_{poloidal-length}}} \end{eqnarray}
</p>
 where \(i\) labels the interfaces, and <p class="formulaDsp">
\begin{eqnarray} \Theta_{i,\theta} &amp; \equiv &amp; \frac{x \, y_\theta - x_\theta \, y}{x^2+y^2}, \\ M_i &amp; \equiv &amp; \frac{\sum_j m_j^p ( R_{j,i}^2 + Z_{j,i}^2 )}{\sum_j ( R_{j,i}^2 + Z_{j,i}^2 )} ,\\ {\color{red}{L_i}} &amp; \equiv &amp; {\color{red}{\sqrt{ [R_{i}(\theta,\zeta)-R_{i-1}(\theta,\zeta)]^2+[Z_{i}(\theta,\zeta)-Z_{i-1}(\theta,\zeta)]^2}}}, \end{eqnarray}
</p>
 and where \(j\) labels the Fourier harmonics. The \(\alpha_i\), \(\beta_i\), \(\gamma_i\) and \(\delta_i \equiv \) <code>sweight</code> are user-supplied weight factors.  </li>
<li>
The polar constraint is derived from defining \(\tan \Theta \equiv y/x\), where <p class="formulaDsp">
\begin{eqnarray} x(\theta,\zeta) &amp; \equiv &amp; R_{i}(\theta,\zeta)-R_{i,0}(\zeta), \\ y(\theta,\zeta) &amp; \equiv &amp; Z_{i}(\theta,\zeta)-Z_{i,0}(\zeta), \end{eqnarray}
</p>
 and where the geometric center of each interface is given by the arc-length weighted integrals, see <a class="el" href="group__grp__coord__axis.html#ga564281be4d9806d0688a717314ad748f" title="The coordinate axis is assigned via a poloidal average over an arbitrary surface.">rzaxis()</a>, <p class="formulaDsp">
\begin{eqnarray} R_{i,0} &amp; \equiv &amp; \int_0^{2\pi} \!\!\!\! d\theta \; R_i(\theta,\zeta) \sqrt{R_{i,\theta}(\theta,\zeta)^2+Z_{i,\theta}(\theta,\zeta)^2}, \\ Z_{i,0} &amp; \equiv &amp; \int_0^{2\pi} \!\!\!\! d\theta \; Z_i(\theta,\zeta) \sqrt{R_{i,\theta}(\theta,\zeta)^2+Z_{i,\theta}(\theta,\zeta)^2}, \end{eqnarray}
</p>
 and \(\cos \Theta = x / \sqrt{x^2+y^2}\) has been used to simplify the expressions and to avoid divide-by-zero.  </li>
<li>
Only "poloidal tangential" variations will be allowed to find the extremum of \(F\), which are described by <p class="formulaDsp">
\begin{eqnarray} \delta R_i(\theta,\zeta) &amp; \equiv &amp; R_{i,\theta}(\theta,\zeta) \, \delta u_i(\theta,\zeta),\\ \delta Z_i(\theta,\zeta) &amp; \equiv &amp; Z_{i,\theta}(\theta,\zeta) \, \delta u_i(\theta,\zeta), \end{eqnarray}
</p>
 from which it follows that the variation in each Fourier harmonic is <p class="formulaDsp">
\begin{eqnarray} \delta R_{j,i} = \displaystyle \oint\!\!\!\oint \!d\theta d\zeta \,\,\, R_{i,\theta}(\theta,\zeta) \, \delta u_i(\theta,\zeta) \, \cos(m_j\theta-n_j\zeta), \\ \delta Z_{j,i} = \displaystyle \oint\!\!\!\oint \!d\theta d\zeta \,\,\, Z_{i,\theta}(\theta,\zeta) \, \delta u_i(\theta,\zeta) \, \sin(m_j\theta-n_j\zeta), \end{eqnarray}
</p>
 and <p class="formulaDsp">
\begin{eqnarray} \delta R_{i,\theta}(\theta,\zeta) &amp; \equiv &amp; R_{i,\theta\theta}(\theta,\zeta) \, \delta u_i(\theta,\zeta) + R_{i,\theta}(\theta,\zeta) \, \delta u_{i,\theta} (\theta,\zeta) \\ \delta Z_{i,\theta}(\theta,\zeta) &amp; \equiv &amp; Z_{i,\theta\theta}(\theta,\zeta) \, \delta u_i(\theta,\zeta) + Z_{i,\theta}(\theta,\zeta) \, \delta u_{i,\theta} (\theta,\zeta) \end{eqnarray}
</p>
  </li>
<li>
The variation in \(F\) is <p class="formulaDsp">
\begin{eqnarray} \delta F &amp; = &amp; \sum_{i=1}^{N-1} \alpha_i \;\;\;\oint\!\!\!\oint \!d\theta d\zeta \,\,\, \!\! \left( \frac{-2\Theta_{i,\theta\theta}}{\Theta_{i,\theta}^2} \right) \delta u_i \nonumber \\ &amp; + &amp; \sum_{i=1}^{N-1} \beta_i \;\;\;\oint\!\!\!\oint \!d\theta d\zeta \,\,\, \!\! \left( R_{i,\theta} X_i + Z_{i,\theta} Y_i \right) \delta u_i \nonumber \\ &amp; + &amp; \sum_{i=1}^{N-1} \gamma_i \;\;\; \int \! d\zeta \; \left( Z_{i}(0,\zeta)-Z_{i,0} \right) Z_{i,\theta} \; \delta u_i \nonumber \\ &amp; + &amp; {\color{red}{\sum_{i=1}^{N-1} \delta_i \;\;\;\oint\!\!\!\oint \!d\theta d\zeta \,\,\, \!\! \left( \frac{\Delta R_{i } R_{i,\theta} + \Delta Z_{i } Z_{i,\theta}}{L_{i }} \right) \delta u_i}} \nonumber \\ &amp; - &amp; {\color{red}{\sum_{i=1}^{N-1} \delta_{i+1} \oint\!\!\!\oint \!d\theta d\zeta \,\,\, \!\! \left( \frac{\Delta R_{i+1} R_{i,\theta} + \Delta Z_{i+1} Z_{i,\theta}}{L_{i+1}} \right) \delta u_i}} \label{eq:firstvariation_lforce} \end{eqnarray}
</p>
 where, for the stellarator symmetric case, <p class="formulaDsp">
\begin{eqnarray} X_i &amp; \equiv &amp; \displaystyle \sum\nolimits_j ( m_j^p - M_i ) \, R_{j,i} \cos(m_j\theta-n_j\zeta), \\ Y_i &amp; \equiv &amp; \displaystyle \sum\nolimits_j ( m_j^p - M_i ) \, Z_{j,i} \sin(m_j\theta-n_j\zeta), \end{eqnarray}
</p>
 and <p class="formulaDsp">
\begin{eqnarray} {\color{red}{\Delta R_{i}}} &amp; \equiv &amp; {\color{red}{R_{i}(\theta,\zeta)-R_{i-1}(\theta,\zeta)}},\\ {\color{red}{\Delta Z_{i}}} &amp; \equiv &amp; {\color{red}{Z_{i}(\theta,\zeta)-Z_{i-1}(\theta,\zeta)}}, \end{eqnarray}
</p>
  </li>
<li>
The spectral constraints derived from Eqn. \((\ref{eq:firstvariation_lforce})\) are <p class="formulaDsp">
\begin{eqnarray} I_i(\theta,\zeta) &amp; \equiv &amp; - 2 \alpha_i \frac{\Theta_{i,\theta\theta}}{\Theta_{i,\theta}^{2}} + \beta_i \left( R_{i,\theta} X_i + Z_{i,\theta} Y_i \right) + \gamma_i \left( Z_{i}(0,\zeta) - Z_{i,0} \right) Z_{i,\theta}(0,\zeta) \nonumber \\ &amp; + &amp; {\color{red}{\delta_{i } \frac{\Delta R_{i } R_{i,\theta} + \Delta Z_{i } Z_{i,\theta}}{L_i}}} - {\color{red}{\delta_{i+1} \frac{\Delta R_{i+1} R_{i,\theta} + \Delta Z_{i+1} Z_{i,\theta}}{L_{i+1} } } } \label{eq:spectralconstraints_lforce} \end{eqnarray}
</p>
  </li>
<li>
Note that choosing \(p=2\) gives \(X=-R_{\theta\theta}\) and \(Y=-Z_{\theta\theta}\), and the spectrally condensed angle constraint, \(R_\theta X + Z_\theta Y=0\), becomes \(\partial_\theta (R_\theta^2+Z_\theta^2)=0\), which defines the equal arc length angle.  </li>
<li>
The poloidal-angle origin term, namely \(\gamma_i \left( Z_{i}(0,\zeta) - Z_{i,0} \right) Z_{i,\theta}(0,\zeta)\) is only used to constrain the \(m_j=0\) harmonics.  </li>
<li>
The construction of the angle functional was influenced by the following considerations:  <ul>
<li>
The minimal spectral width constraint is very desirable as it reduces the required Fourier resolution, but it does not constrain the \(m=0\) harmonics and the minimizing spectral-width poloidal-angle may not be consistent with the poloidal angle used on adjacent interfaces.  </li>
<li>
The regularization of the vector potential and the coordinate interpolation near the coordinate origin (see elsewhere) assumes that the poloidal angle is the polar angle.  </li>
<li>
The user will provide the Fourier harmonics of the boundary, and thus the user will implicitly define the poloidal angle used on the boundary.  </li>
<li>
Minimizing the length term will ensure that the poloidal angle used on each interface is smoothly connected to the poloidal angle used on adjacent interfaces.  </li>
</ul>
</li>
<li>
A suitable choice of the weight factors, \(\alpha_i\), \(\beta_i\), \(\gamma_i\) and \(\delta_i\), will ensure that the polar constraint dominates for the innermost surfaces and that this constraint rapidly becomes insignificant away from the origin; that the minimal spectral constraint dominates in the "middle"; and that the minimizing length constraint will be significant near the origin and dominant near the edge, so that the minimizing spectral width angle will be continuously connected to the polar angle on the innermost surfaces and the user-implied angle at the plasma boundary. The length constraint should not be insignificant where the spectral constraint is dominant (so that the \(m=0\) harmonics are constrained).  </li>
<li>
The polar constraint does not need normalization. The spectral width constraint has already been normalized. The length constraint is not yet normalized, but perhaps it should be.  </li>
<li>
The spectral constraints given in Eqn. \((\ref{eq:spectralconstraints_lforce})\) need to be differentiated with respect to the interface Fourier harmonics, \(R_{j,i}\) and \(Z_{j,i}\). The first and second terms lead to a block diagonal hessian, and the length term leads to a block tri-diagonal hessian.  </li>
<li>
Including the poloidal-angle origin constraint means that the polar angle constraint can probably be ignored, i.e. \(\alpha_i=0\).  </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lvol</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iocons</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ideriv</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Ntz</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dBB</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">XX</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">YY</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">length</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">DDl</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">MMl</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iflag</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="group__grp__global__physicslist.html#ga1b110ff3c17b7dac3af444ab9e42e3d2">inputlist::adiabatic</a>, <a class="el" href="group__grp__vecpot.html#ga430fa6f9a3ebb7a56185b72b8ea1ff49">allglobal::ate</a>, <a class="el" href="group__grp__vecpot.html#gaefec3203c02505c73b48dbb1c7ba96c1">allglobal::ato</a>, <a class="el" href="group__grp__vecpot.html#gad85df9e26321392291e0a43478da0f3c">allglobal::aze</a>, <a class="el" href="group__grp__vecpot.html#gad52dcff52cc620916d5e765051a0228a">allglobal::azo</a>, <a class="el" href="group__grp__force__constr.html#ga468c455230178a907affbc00a564e4f1">allglobal::bemn</a>, <a class="el" href="group__grp__force__constr.html#ga73a86e10824f23ba83def102e7d4b0c0">allglobal::bomn</a>, <a class="el" href="namespaceallglobal.html#af3f23b45db519a643eea14b410e6d428">allglobal::build_vector_potential()</a>, <a class="el" href="group__grp__fourier__transform.html#ga77de10a2effb1f42cde73eccb9739ba9">allglobal::cfmn</a>, <a class="el" href="group__grp__fourier__transform.html#gae1ccb61fefa1682f6e43b8d05ad75bd4">allglobal::comn</a>, <a class="el" href="group__grp__geometry.html#gaaca20aa60eaf39055f3c9d5c02a24ac2">coords()</a>, <a class="el" href="namespaceallglobal.html#afae71b580d9f9c71a6796207a5411959">allglobal::cpus</a>, <a class="el" href="group__grp__iface__geom.html#ga4b9388877c5ab6690c339e765b358fe7">allglobal::drij</a>, <a class="el" href="group__grp__iface__geom.html#ga18494687040caa3b3c9bd9a04fe334d4">allglobal::dzij</a>, <a class="el" href="group__grp__fourier__transform.html#ga8c1126783337bb324fe747f00104749e">allglobal::efmn</a>, <a class="el" href="group__grp__fourier__transform.html#ga03a90b1d4526190ab22932237d612316">allglobal::evmn</a>, <a class="el" href="group__grp__global__physicslist.html#ga778f38f46639ce987228193dbc29626d">inputlist::gamma</a>, <a class="el" href="group__grp__fourier__transform.html#ga0111c19dc8a8bbde00b38606f9df1c88">allglobal::guvij</a>, <a class="el" href="namespaceconstants.html#a28ec2b391ac319cee0f31bb295b89cc2">constants::half</a>, <a class="el" href="group__grp__force__constr.html#gaac42d2c1752a3a067a30d4e02f9a2fb5">allglobal::iemn</a>, <a class="el" href="group__grp__global__physicslist.html#gaa6dcbfd2f5cb5f23f4bc567fb13ae0e2">inputlist::igeometry</a>, <a class="el" href="group__grp__fourier__transform.html#ga61de5564536d1d82a7248c7052fe8de2">allglobal::ijimag</a>, <a class="el" href="group__grp__fourier__transform.html#ga16a474ec37a253d5b4477d6b7f4da9ff">allglobal::ijreal</a>, <a class="el" href="group__grp__fourier__repr.html#gaeac30068003c58add7893688ea2e48aa">allglobal::im</a>, <a class="el" href="group__grp__fourier__repr.html#gae946717d1654463c7cb4b1d7fd712f7d">allglobal::in</a>, <a class="el" href="group__grp__force__constr.html#gac07edf1398510e17092e1a3dddcc0726">allglobal::iomn</a>, <a class="el" href="group__grp__iface__geom.html#ga9f6e014546551429956a2a47c134d07b">allglobal::irbc</a>, <a class="el" href="group__grp__iface__geom.html#ga05ba18442623cf5f34f7a2193a03e0b1">allglobal::irbs</a>, <a class="el" href="group__grp__iface__geom.html#ga073e40076931980ddd1ff91dc2b9743f">allglobal::irij</a>, <a class="el" href="group__grp__iface__geom.html#ga6c7ad3b18081227f992e4c3e73a2e216">allglobal::izbc</a>, <a class="el" href="group__grp__iface__geom.html#gadcc12f5e32287fd4b60dc01afc6e64d2">allglobal::izbs</a>, <a class="el" href="group__grp__iface__geom.html#ga0d167c6ccafc8d639a630f6f9da74506">allglobal::izij</a>, <a class="el" href="group__grp__fourier__transform.html#gaad4cc6a24c2bc6f31023fe55f8d44bd3">allglobal::jiimag</a>, <a class="el" href="group__grp__fourier__transform.html#ga5d6c2633274202e97562b9d81c836e40">allglobal::jireal</a>, <a class="el" href="group__grp__global__diagnostics.html#ga9bd118017d70e35d658a10463ab4c1dc">inputlist::lcheck</a>, <a class="el" href="group__grp__vecpot.html#gad6a2a40a248c2d81155a94b2dfe9b480">allglobal::lcoordinatesingularity</a>, <a class="el" href="group__grp__local__force.html#ga7a5316b9e5eeb42811aa6bccd29a132f">lforce()</a>, <a class="el" href="group__grp__global__physicslist.html#ga1509b6ce73e909b86beaf65c26527932">inputlist::lrad</a>, <a class="el" href="group__grp__fourier__repr.html#ga4d6db839ef2835ee34f9e87ae0fdf14a">allglobal::mmpp</a>, <a class="el" href="group__grp__fourier__repr.html#ga3b3045dc5c13351cded37581bdfb3400">allglobal::mn</a>, <a class="el" href="namespaceallglobal.html#a2382df770fc57cc53ed68c6e1ac23819">allglobal::mpi_comm_spec</a>, <a class="el" href="namespaceallglobal.html#aa2a4850f9468d817a673c1ef7f718849">allglobal::mvol</a>, <a class="el" href="namespaceallglobal.html#aca1163f9aab48251a99d00e63618cc39">allglobal::myid</a>, <a class="el" href="namespaceallglobal.html#aa45097c36006ab1ffc0cb06a927ed02a">allglobal::ncpu</a>, <a class="el" href="namespaceallglobal.html#a6993aa662f74b327357896c7d9c81f4b">allglobal::notstellsym</a>, <a class="el" href="group__grp__fourier__transform.html#ga2a7d2dbc4637d792e1eeabcd4ee5564e">allglobal::nt</a>, <a class="el" href="group__grp__global__physicslist.html#gafdbe1fac5fd98bb41ae5cc363ab9aedd">inputlist::nvol</a>, <a class="el" href="group__grp__fourier__transform.html#gaa91566c55f28df38e46ffc19e60f766f">allglobal::nz</a>, <a class="el" href="group__grp__fourier__transform.html#gaebdaefaf68008cc122895a223c69a3a8">allglobal::odmn</a>, <a class="el" href="group__grp__fourier__transform.html#gaedb347c6ba031b77ee637a09b6d7aff7">allglobal::ofmn</a>, <a class="el" href="namespaceconstants.html#ad5224c0b5e13bf12b18dafbb62ba4e8d">constants::one</a>, <a class="el" href="namespacefileunits.html#a7463305b9ff5b4b659d87f6fa59f74a7">fileunits::ounit</a>, <a class="el" href="group__grp__force__constr.html#gab201ee670b27edb52008621da3640e15">allglobal::pemn</a>, <a class="el" href="group__grp__force__constr.html#ga68e11a67f86e012952a528b1c98252a3">allglobal::pomn</a>, <a class="el" href="group__grp__global__physicslist.html#ga89fd8fbe67af2b8e72dbcb9440c7b797">inputlist::pscale</a>, <a class="el" href="group__grp__fourier__repr.html#ga9a3040af9af01340bb79b58e53956a50">allglobal::regumm</a>, <a class="el" href="namespaceallglobal.html#ac645f8f9aa18846027d3361d1e6c315c">allglobal::rtt</a>, <a class="el" href="group__grp__force__constr.html#ga8442ed8bc98d6b1a379f307e1e026ca6">allglobal::semn</a>, <a class="el" href="group__grp__fourier__transform.html#ga45e62efd92657124df197ceac8133393">allglobal::sfmn</a>, <a class="el" href="group__grp__fourier__transform.html#ga4b1c60e25eab68b6372bf28f84aecc97">allglobal::sg</a>, <a class="el" href="group__grp__fourier__transform.html#gaefb7a462fa8aafa9cb735e81f4152784">allglobal::simn</a>, <a class="el" href="group__grp__force__constr.html#ga814cd3b7d34578905279db2c8e5fe9e5">allglobal::somn</a>, <a class="el" href="group__grp__iface__geom.html#ga3c0cbb57d90e281734cb62b6802c7477">allglobal::trij</a>, <a class="el" href="namespaceallglobal.html#a0ff41ecfbb162f4712030c7806852615">allglobal::tt</a>, <a class="el" href="namespaceconstants.html#a77f9c93617de9c40ab41a50a157fb90d">constants::two</a>, <a class="el" href="group__grp__iface__geom.html#ga038ab443cc07f6a754154a4163699afd">allglobal::tzij</a>, <a class="el" href="group__grp__volints.html#ga8f3eaacd48bc30ec4332e1216213089f">allglobal::vvolume</a>, <a class="el" href="namespaceallglobal.html#a1f4ddb89b3246fef8d73c88b730eda3a">allglobal::yesstellsym</a>, and <a class="el" href="namespaceconstants.html#ab2b0340319f61089513f5dd1d3971a47">constants::zero</a>.</p>

<p class="reference">Referenced by <a class="el" href="dfp200_8f90.html#a55ea75395f8c71731451e1add3720c7e">dfp200()</a>, <a class="el" href="dfp200_8f90.html#a7b64c7392b45d0042d8bd7379c0761a5">evaluate_dbb()</a>, and <a class="el" href="group__grp__local__force.html#ga7a5316b9e5eeb42811aa6bccd29a132f">lforce()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__local__force_ga7a5316b9e5eeb42811aa6bccd29a132f_cgraph.svg" width="371" height="152"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__grp__local__force_ga7a5316b9e5eeb42811aa6bccd29a132f_icgraph.svg" width="1043" height="534"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
